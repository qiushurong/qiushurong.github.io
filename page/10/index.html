<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.useso.com/css?family=Monda:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  




<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="小树,邱树荣,小树技术博客,小树博客" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/head.ico?v=5.0.1" />






<meta name="description" content="致力于计算机程式开发">
<meta property="og:type" content="website">
<meta property="og:title" content="小树技术博客">
<meta property="og:url" content="http://yoursite.com/page/10/index.html">
<meta property="og:site_name" content="小树技术博客">
<meta property="og:description" content="致力于计算机程式开发">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小树技术博客">
<meta name="twitter:description" content="致力于计算机程式开发">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 5322878,
      author: '小树'
    }
  };
</script>

  <title> 小树技术博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  

  <div class="container one-collumn  
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">小树技术博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">用文字留住时间、用博客记录生命</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/20/webpage-data-collector-3/" itemprop="url">
                  Java网页数据采集器[下篇-数据查询]
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-20T19:42:27+08:00" content="2014-02-20">
              2014-02-20
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 4,255</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 21分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-SE/" itemprop="url" rel="index">
                    <span itemprop="name">Java SE</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/20/webpage-data-collector-3/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/20/webpage-data-collector-3/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本期概述<br>上一期我们学习了如何将html采集到的数据存储到MySql数据库中,这期我们来学习下如何在存储的数据中查询我们实际想看到的数据.</p>
</blockquote>
<p>数据采集页面 <a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">2011-2012赛季英超球队战绩</a></p>
<p>&nbsp;</p>
<blockquote>
<p>如果是初学者 以下可能对你有帮助</p>
<ul>
<li>Java如何操作MySql?<br>在使用java 操作MySql数据库之前 我们需要在项目文件中导入 一个jar包(mysql-connector-java-5.1.18-bin)</li>
</ul>
</blockquote>
<p>可以在MySql官网下载 <a href="http://www.mysql.com/downloads/connector/j/" target="_blank" rel="external">Connector/J 5.1.18</a></p>
<p>第一次使用MySql?   请看 <a href="http://www.cnblogs.com/longwu/articles/2310577.html" target="_blank" rel="external">java连接MYSQL </a></p>
<blockquote>
<ul>
<li>如何在java项目中导入jar包?<br>请看这个 <a href="http://blog.csdn.net/justinavril/article/details/2783182" target="_blank" rel="external">Eclipse下如何导入jar包</a></li>
<li>如何安装MySql数据库?<br>如果是初学者 想使用MySql数据库的话 可以去这里 <a href="http://www.apachefriends.org/zh_cn/xampp.html" target="_blank" rel="external">XAMPP中文官网</a>  下载 XAMPP 套装</li>
</ul>
</blockquote>
<p>XAMPP（Apache+MySQL+PHP+PERL）是一个功能强大的建 XAMPP 软件站集成软件包, 而且一键式安装, 无需修改配置文件,非常好用.</p>
<p>&nbsp;</p>
<p>关于,如何在MySql里创建数据库,请看<a href="http://www.cnblogs.com/longwu/archive/2012/01/03/2310588.html" title="Java网页数据采集器实例教程[中篇-数据存储]" target="_blank" rel="external">Java网页数据采集器实例教程[中篇-数据存储]</a>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>数据库准备好了,我们开始写java程序代码;</p>
<p>这期,我们主要在MySql 类里增加了一个数据查看的方法 queryMySql(),并增加了一个 DataQuery类, 包含了一些比赛结果的查询方法.</p>
<p>&nbsp;</p>
<p>主程序代码</p>
<p>这里简单介绍下各个类以及包含的方法</p>
<p>DataCollectionAndStorage类 和里面的dataCollectAndStore() 方法 用于Html数据采集和存储</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><pre class="brush:java"><br>import java.io.BufferedReader;<br>import java.io.IOException;<br>import java.io.InputStreamReader;<br>import java.net.URL;<br>/**</pre></p>
<ul>
<li>DataCollectionAndStorage类 用于数据的收集和存储</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br><em>/<br>public class DataCollectionAndStorage {<br>/*</em></p>
<ul>
<li><p>dataCollectAndStore()方法  用于Html数据收集和存储<br>*/<br>public void dataCollectAndStore() {<br>  // 首先用一个字符串 来装载网页链接<br>  String strUrl = “<a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">http://www.footballresults.org/league.php?all=1&amp;league=EngPrem</a>“;</p>
<p>  String sqlLeagues = “”;<br>  try {</p>
<pre><code>// 创建一个url对象来指向 该网站链接 括号里()装载的是该网站链接的路径
// 更多可以看看 http://wenku.baidu.com/view/8186caf4f61fb7360b4c6547.html
URL url = new URL(strUrl);
// InputStreamReader 是一个输入流读取器 用于将读取的字节转换成字符
// 更多可以看看 http://blog.sina.com.cn/s/blog_44a05959010004il.html
InputStreamReader isr = new InputStreamReader(url.openStream(),
        &quot;utf-8&quot;); // 统一使用utf-8 编码模式
// 使用 BufferedReader 来读取 InputStreamReader 转换成的字符
BufferedReader br = new BufferedReader(isr);
String strRead = &quot;&quot;; // new 一个字符串来装载 BufferedReader 读取到的内容

// 定义3个正则 用于获取我们需要的数据
String regularDate = &quot;(\d{1,2}\.\d{1,2}\.\d{4})&quot;;
String regularTwoTeam = &quot;&gt;[^&lt;&gt;]*&lt;/a&gt;&quot;;
String regularResult = &quot;&gt;(\d{1,2}-\d{1,2})&lt;/TD&gt;&quot;;

//创建 GroupMethod类的对象 gMethod 方便后期调用其类里的 regularGroup方法
GroupMethod gMethod = new GroupMethod();
//创建DataStructure数据结构 类的对象   用于数据下面的数据存储
DataStructure ds = new DataStructure();
//创建MySql类的对象 用于执行MySql语句
MySql ms = new MySql();
int i = 0; // 定义一个i来记录循环次数 即收集到的球队比赛结果数
int index = 0; // 定义一个索引 用于获取分离 2个球队的数据 因为2个球队正则是相同的
// 开始读取数据 如果读到的数据不为空 则往里面读
while ((strRead = br.readLine()) != null) {
    /**
     * 用于捕获日期数据
     */
    String strGet = gMethod.regularGroup(regularDate, strRead);
    // 如果捕获到了符合条件的 日期数据 则打印出来

    if (!strGet.equals(&quot;&quot;)) {
        //System.out.println(&quot;Date:&quot; + strGet);
        //将收集到的日期存在数据结构里
        ds.date = strGet;
        // 这里索引+1 是用于获取后期的球队数据
        ++index; // 因为在html页面里 源代码里 球队数据是在刚好在日期之后
    }
    /**
     * 用于获取2个球队的数据
     */
    strGet = gMethod.regularGroup(regularTwoTeam, strRead);
    if (!strGet.equals(&quot;&quot;) &amp;&amp; index == 1) { // 索引为1的是主队数据
        // 通过subtring方法 分离出 主队数据
        strGet = strGet.substring(1, strGet.indexOf(&quot;&lt;/a&gt;&quot;));
        //System.out.println(&quot;HomeTeam:&quot; + strGet); // 打印出主队
        //将收集到的主队名称 存到 数据结构里
        ds.homeTeam = strGet;
        index++; // 索引+1之后 为2了
        // 通过subtring方法 分离出 客队
    } else if (!strGet.equals(&quot;&quot;) &amp;&amp; index == 2) { // 这里索引为2的是客队数据
        strGet = strGet.substring(1, strGet.indexOf(&quot;&lt;/a&gt;&quot;));
        //System.out.println(&quot;AwayTeam:&quot; + strGet); // 打印出客队
        //将收集到的客队名称 存到数据结构里
        ds.awayTeam = strGet;
        index = 0;  //收集完客队名称后 需要将索引还原 用于收集下一条数据的主队名称
    }
    /**
     * 用于获取比赛结果
     */
    strGet = gMethod.regularGroup(regularResult, strRead);
    if (!strGet.equals(&quot;&quot;)) {
        // 这里同样用到了substring方法 来剔除&apos;&lt;&apos; 和 &quot;&lt;/TD&gt;&quot; 标签 来获取我们想要的比赛结果
        strGet = strGet.substring(1, strGet.indexOf(&quot;&lt;/TD&gt;&quot;));
        //System.out.println(&quot;Result:&quot; + strGet);
        ds.result = strGet; //将收集到的比赛结果存到数据结构里
        //System.out.println();

        //MySql插入语句
        sqlLeagues = &quot;INSERT INTO Premiership values(&quot;&quot;
                + ds.date + &quot;&quot;,&quot; + &quot;&quot;&quot; + ds.homeTeam
                + &quot;&quot;,&quot; + &quot;&quot;&quot; + ds.awayTeam + &quot;&quot;,&quot;+ &quot;&quot;&quot; + ds.result + &quot;&quot;)&quot;;
        //调用MySql类的datatoMySql()方法 来执行 MySql插入语句
        ms.datatoMySql(sqlLeagues);
        i++; //每插入完一条记录 i+1;
        System.out.println(&quot;第&quot;+i+&quot;条数据插入成功&quot;);
    }
}
// 当读完数据后 记得关闭 BufferReader
br.close();
//System.out.println(&quot;共收集到&quot; + i + &quot;条比赛记录&quot;);// 打印出循环次数
//当数据存储完成后 打印出 收集球队记录数
System.out.println(&quot;数据存储完毕,共插入数据库&quot;+i+&quot;条记录&quot;);
</code></pre><p>  } catch (IOException e) {</p>
<pre><code>// 如果出错 抛出异常
e.printStackTrace();
</code></pre><p>  }<br>}<br>}<br><br>&nbsp;</p>
</li>
</ul>
</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>DataQuery类 里面有4个方法</p>
<ol>
<li>initialDataBase() 用于清空数据库里的所有比赛数据</li>
<li>getAllTeams()    用于获取当前数据库里所有球队的名字</li>
<li>querySpecifiedTeam()   用于查询具体球队的比赛情况 (可以查看你喜欢的球队比赛结果)</li>
<li><p>queryByDate()  用于查询具体日期的比赛 (查询某一天的比赛结果)</p>
<div></div><br><div></div><br><pre class="brush:java"><br>import java.sql.ResultSet;<br>import java.sql.SQLException;<br>import java.util.ArrayList;<br>import java.util.List;<br>import java.util.Vector;<br>/<strong><br><em> DataQuery 类  用于查询数据库里的信息 包含了不同的方法
</em> @author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class DataQuery {<br>/</strong><br> <em> 用于清空数据库里比赛结果
 </em>/<br>public void initialDataBase() {<br>    String initialSql = “delete from premiership”;<br>    MySql ms = new MySql();<br>    try {<br>        //MySql类里 提供了一个 删除数据的 方法 executeUpdate()<br>        ms.datatoMySql(initialSql);<br>        System.out.println(“数据库清空成功!”);<br>    } catch (Exception e) {<br>        System.out.println(“数据库清空失败!”);<br>    }<br>}<br><br>/<strong><br> <em> 用于 获取当前数据库里一共有多少球队 方便后期查看自己喜欢的球队比赛成绩
 </em> @return 所有的参与过比赛的球队名<br> */<br>public Vector<string> getAllTeams() {<br>    //使用一个向量来 存取 从数据库中读到的值<br>    Vector<string> vecAllTeams = new Vector<string>();<br>    String allteamsSql = “select HomeTeam,AwayTeam from premiership group by HomeTeam;”;<br>    ResultSet rs = null;<br>    MySql ms = new MySql();<br>    //调用 MySql类里 查看数据的方法<br>    rs = ms.queryMySql(allteamsSql);<br>    try {<br>        //如果 ResultSet数据集里的数据不为空  则获取相应的 数据 添加到 向量vecAllTeams里<br>        while (rs.next()) {<br>            if (!vecAllTeams.contains(rs.getString(“HomeTeam”)))<br>                vecAllTeams.add(rs.getString(“HomeTeam”));<br>            else if (!vecAllTeams.contains(rs.getString(“AwayTeam”)))<br>                vecAllTeams.add(rs.getString(“AwayTeam”));<br>        }<br><br>    } catch (SQLException e) {<br>        System.out.println(e.getMessage());<br>        e.printStackTrace();<br>    }<br>    //返回 取到的所有结果<br>    return vecAllTeams;<br><br>}<br><br>/</string></string></string></strong><br> <em> 查看具体的球队比赛结果
 </em> @param league<br> <em> @return 具体球队的所有比赛结果
 </em>/<br>public Vector<string> querySpecifiedTeam(String league) {<br>    //创建一个向量 来装载 从数据库中 读到的数据<br>    Vector<string> lsMatches = new Vector<string>();<br>    String specifiedTeamSql = “select <em> from premiership where HomeTeam =’”<br>            + league + “‘ or AwayTeam =’” + league + “‘“;<br>    MySql ms = new MySql();<br>    ResultSet rs = null;<br>    rs = ms.queryMySql(specifiedTeamSql);<br>    try {<br>        while (rs.next()) {<br>            lsMatches.add(rs.getString(“Date”));<br>            lsMatches.add(rs.getString(“HomeTeam”));<br>            lsMatches.add(rs.getString(“AwayTeam”));<br>            lsMatches.add(rs.getString(“Result”));<br>        }<br>    } catch (SQLException e) {<br>        e.printStackTrace();<br>    }<br>    return lsMatches;<br><br>}<br>/**
</em> 查看 某一天的 比赛结果<br><em> @param date
</em> @return 某一天的所有比赛结果<br><em>/<br>public List<string> queryByDate(String date) {<br>    //使用一个 list泛型来装载 比赛结果<br>    List<string> lsMatchesOnDate = new ArrayList<string>();<br>    String sqlDate = “SELECT </string></string></string></em> FROM premiership WHERE Date =’” + date + “‘“;<br>    //创建一个ResultSet数据集  用来 获取查询到的结果集<br>    ResultSet rs = null;<br>    MySql ms = new MySql();<br>    //调用 MySql 类里的 查看数据库数据的方法<br>    rs = ms.queryMySql(sqlDate);<br>    try {<br>        //如果 ResultSet数据集 不为空<br>        while (rs.next()) {<br>            //则 从ResultSet数据集 中取出 相应的 字段值 添加到 list泛型里<br>            lsMatchesOnDate.add(rs.getString(“Date”));<br>            lsMatchesOnDate.add(rs.getString(“HomeTeam”));<br>            lsMatchesOnDate.add(rs.getString(“AwayTeam”));<br>            lsMatchesOnDate.add(rs.getString(“Result”));<br>        }<br>    } catch (SQLException e) {<br>        System.out.println(e.getMessage());<br>        e.printStackTrace();<br>    }<br>    //最后 返回 取到的所有比赛数据结果<br>    return lsMatchesOnDate;<br>}<br>}<br></string></string></string></pre><br><div></div><br><div></div>

</li>
</ol>
<!--nextpage-->
<p><div></div></p>
<p><div>DataStructure类 一个简单的数据结构 用于收集到数据的临时性存储</div></p>
<p><div></div></p>
<p><div></div></p>
<p><pre class="brush:java"><br>/**</pre></p>
<ul>
<li>DataStructure 类 一个简单的数据结构</li>
<li>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br><em>/<br>public class DataStructure {<br> //定义数据字段<br> public String homeTeam;<br> public String awayTeam;<br> public String date;<br> public String result;<br>}<br><br><div></div><br><div></div><br><div></div><br><div></div><br><div>GroupMethod类 里面包含了regularGroup() 方法 用于匹配并获取 html的数据</div><br><div></div><br><div></div><br><pre class="brush:java"><br>import java.util.regex.Matcher;<br>import java.util.regex.Pattern;<br>/*</pre></em></li>
<li>GroupMethod 类 用于匹配和抓取 html页面的数据</li>
<li>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class GroupMethod {<br> // 传入2个字符串参数 一个是pattern(我们使用的正则) 另一个matcher是html源代码<br> public String regularGroup(String pattern, String matcher) {<pre><code>Pattern p = Pattern.compile(pattern, Pattern.CASE_INSENSITIVE);
Matcher m = p.matcher(matcher);
if (m.find()) { // 如果读到
    return m.group();// 返回捕获的数据
} else {
    return &quot;&quot;; // 否则返回一个空字符串
}
</code></pre> }<br>}<br><br><div></div><br><div></div><br><div></div><br><div></div><div>

</div></li>
</ul>
<p>MySql类 里面含有2个方法</p>
<ul>
<li>datatoMySql() 方法 用于向数据库里插入数据</li>
<li>queryMySql() 方法 用于查看数据库里存储的数据<br><br><div></div><br><div></div><br><pre class="brush:java"><br>import java.sql.Connection;<br>import java.sql.DriverManager;<br>import java.sql.ResultSet;<br>import java.sql.SQLException;<br>import java.sql.Statement;</pre></li>
</ul>
<p>/**</p>
<ul>
<li>MySql类用于实施MySql数据库操作</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class MySql {</p>
<p> // 定义MySql驱动,数据库地址,数据库用户名 密码, 执行语句和数据库连接<br> public String driver = “com.mysql.jdbc.Driver”;<br> public String url = “jdbc:mysql://127.0.0.1:3306/htmldatacollection”;<br> public String user = “root”;<br> public String password = “root”;<br> public Statement stmt = null;<br> public Connection conn = null;</p>
<p> /**</p>
<ul>
<li>创建一个插入数据的方法  executeUpdate()</li>
<li><p>@param insertSQl<br>*/<br>public void datatoMySql(String insertSQl) {</p>
<p> try {</p>
<pre><code>try {
    Class.forName(driver).newInstance();
} catch (Exception e) {
    System.out.println(&quot;无法找到驱动器&quot;);
    e.printStackTrace();
}
// 创建连接
conn = DriverManager.getConnection(url, user, password);
// 创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
// 执行SQL 插入语句
stmt.executeUpdate(insertSQl);
// 执行完 停止执行语句
stmt.close();
// 执行完关闭数据库连接
conn.close();
</code></pre><p> } catch (Exception e) {</p>
<pre><code>System.out.println(e.getMessage());
e.printStackTrace();
</code></pre><p> }<br>}</p>
<p>/**</p>
</li>
<li>创建一个用于select查看数据的方法 executeQuery();</li>
<li>@param strSelect</li>
<li><p>@return ResultSet<br>*/<br>public ResultSet queryMySql(String strSelect) {<br> // 创建一个数据集 用于获取查询到的行数据<br> ResultSet rs = null;<br> try {</p>
<pre><code>Class.forName(driver).newInstance();
</code></pre><p> } catch (Exception e) {</p>
<pre><code>System.out.println(&quot;无法找到驱动器!&quot;);
e.printStackTrace();
</code></pre><p> }</p>
<p> try {</p>
<pre><code>// 创建连接
conn = DriverManager.getConnection(url, user, password);
// 创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
// 执行查询语句   获取ResultSet对象
rs = stmt.executeQuery(strSelect);
</code></pre><p> } catch (SQLException e) {</p>
<pre><code>System.out.println(e.getMessage());
e.printStackTrace();
</code></pre><p> }<br> //返回结果集<br> return rs;<br>}<br>}<br><br><div></div><br><div></div><br><div>Main 主函数 用于数据输出</div><br><div></div><br><pre class="brush:java"><br>import java.util.List;<br>import java.util.Scanner;<br>import java.util.Vector;<br>/**</pre></p>
</li>
</ul>
</li>
<li>Main 主函数 用于数据的输出</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class Main {<br> public static void main(String[] args) {</p>
<pre><code>DataCollectionAndStorage dcs = new DataCollectionAndStorage();
DataQuery dQuery = new DataQuery();

while (true) {
    System.out.println(&quot;清空数据库-请按1&quot;);
    System.out.println(&quot;收集英超比赛数据-请按2&quot;);
    System.out.println(&quot;查看英超所有球队-请按3&quot;);
    System.out.println(&quot;查看具体球队比赛结果-请按4&quot;);
    System.out.println(&quot;查看某一天的比赛-请按5&quot;);
    // Scanner 文本扫描器 用于读取 用户的输入 
    Scanner sc = new Scanner(System.in);
    int intInput = sc.nextInt();
    if (intInput == 1) {
        dQuery.initialDataBase();
        System.out
                .println(&quot;---------------------------------------------&quot;);
    } else if (intInput == 2) {
        dcs.dataCollectAndStore();
        System.out
                .println(&quot;---------------------------------------------&quot;);
    } else if (intInput == 3) {
        //获取 查询到的所有球队名称
        Vector&lt;String&gt; vecAllTeams = dQuery.getAllTeams();
        if (vecAllTeams.size() != 0) {
            System.out.println(&quot;参加过比赛的球队如下:&quot;);
            System.out
                    .print(&quot;-----------------------------------------------&quot;);
            System.out
                    .print(&quot;-----------------------------------------------rn&quot;);
            for (int i = 0; i &lt; vecAllTeams.size(); i++) {
                if (i % 7 == 0 &amp;&amp; i != 0) {
                    System.out.println(&quot;rn&quot;);
                }
                System.out.print(vecAllTeams.get(i) + &quot;t&quot;);
            }
        } else
            System.out.print(&quot;数据库目前没有数据,请按2收集数据!&quot;);
        System.out
                .print(&quot;rn---------------------------------------------&quot;);
        System.out
                .println(&quot;-----------------------------------------------rn&quot;);
    } else if (intInput == 4) {
        System.out.println(&quot;请输入你要查看的球队&quot;);
        Scanner scLeague = new Scanner(System.in);
        String strLeague = scLeague.next();
        //获取 具体球队的比赛结果
        Vector&lt;String&gt; lsResult = dQuery.querySpecifiedTeam(strLeague);
        if (lsResult.size() != 0) {
            System.out.println(&quot;日期ttt主队tt客队tt比分&quot;);
            for (int i = 0; i &lt; lsResult.size(); i++) {
                if (i % 4 == 0 &amp;&amp; i != 0)
                    System.out.println();
                System.out.print(lsResult.get(i) + &quot;tt&quot;);
            }
        } else
            System.out.println(&quot;没有相关球队的记录或数据库没有数据!&quot;);
        System.out
                .println(&quot;rn---------------------------------------------------&quot;);
    } else if (intInput == 5) {
        System.out.println(&quot;请输入你要查看的比赛日期  例子格式[14.01.2012]&quot;);
        Scanner scDate = new Scanner(System.in);
        String strDate = scDate.next();
        //获取具体日期下的 所有比赛
        List&lt;String&gt; lsResulOnDate = dQuery.queryByDate(strDate);
        if (lsResulOnDate.size() != 0) {
            System.out.println(&quot;日期ttt主队tt客队tt比分&quot;);
            for (int i = 0; i &lt; lsResulOnDate.size(); i++) {
                if (i % 4 == 0 &amp;&amp; i != 0)
                    System.out.println();
                System.out.print(lsResulOnDate.get(i) + &quot;tt&quot;);
            }
        } else
            System.out.println(&quot;该天没有比赛 或 数据库没有数据!&quot;);
        System.out
                .println(&quot;rn---------------------------------------------------&quot;);
    }
}
</code></pre><p> }<br>}<br><br><div></div><br><div></div></p>
<!--nextpage-->
<p>运行程序</p>
</li>
</ul>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200452123.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200452123.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入1 清空数据</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200453485.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200453485.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入2 开始收集数据 并存入数据库 - 初始阶段</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200455139.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200455139.png" alt=""></a></p>
<p>&nbsp;</p>
<p>开始收集数据 并存入数据库  - 结束阶段</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200460164.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200460164.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入3 查看所有参与过比赛的球队</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200473030.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200473030.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入4  再输入要查看的具体球队 这里查看的是 Swansea</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200482549.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200482549.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入5  再输入查看具体的日期 这里是 02.01.2012</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200491649.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200491649.png" alt=""></a></p>
<p>&nbsp;</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200493329.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200493329.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入1 我们测试下清空数据的效果 这里显示清空成功</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200494918.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200494918.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入3 查看下是否 真正在数据库中成功清空数据   结果显示 数据库目前没有数据</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200504236.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200504236.png" alt=""></a></p>
<p>这样，我们的数据查询功能也做好了 :)</p>
<p><a href="http://files.cnblogs.com/longwu/htmlDataQuery.zip" target="_blank" rel="external">附上源代码 下载</a></p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/20/webpage-data-collector-2/" itemprop="url">
                  Java网页数据采集器[中篇-数据存储]
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-20T19:25:10+08:00" content="2014-02-20">
              2014-02-20
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 2,712</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 13分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-SE/" itemprop="url" rel="index">
                    <span itemprop="name">Java SE</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/20/webpage-data-collector-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/20/webpage-data-collector-2/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本期概述<br>上期我们学习了html页面的数据采集,为了方便我们今后来调用收集到的数据,首先我们需要学习下如何将这些采集到的数据存储起来(MySql数据库).<br>数据采集页面<br><a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">2011-2012赛季英超球队战绩</a></p>
</blockquote>
<p>关于Java操作MySql</p>
<p>在使用java 操作MySql数据库之前 我们需要在项目文件中导入 一个jar包(mysql-connector-java-5.1.18-bin)</p>
<p>可以在MySql官网下载 <a href="http://www.mysql.com/downloads/connector/j/" target="_blank" rel="external">Connector/J 5.1.18</a></p>
<p>第一次使用MySql?   请看 <a href="http://www.cnblogs.com/longwu/articles/2310577.html" target="_blank" rel="external">java连接MYSQL </a></p>
<p>如何在java项目中导入jar包?</p>
<p>请看这个 <a href="http://blog.csdn.net/justinavril/article/details/2783182" target="_blank" rel="external">Eclipse下如何导入jar包</a></p>
<blockquote>
<p>关于MySql数据库<br>如果是初学者 想使用MySql数据库的话 可以去这里 <a href="http://www.apachefriends.org/zh_cn/xampp.html" target="_blank" rel="external">XAMPP中文官网</a>  下载 XAMPP 套装.</p>
</blockquote>
<p>XAMPP（Apache+MySQL+PHP+PERL）是一个功能强大的建 XAMPP 软件站集成软件包, 而且一键式安装, 无需修改配置文件,非常好用.</p>
<p>好了, 需要准备的事宜都完成了,我们开始写代码.</p>
<p>打开MySql数据库,创建数据库 和表 (拷贝如下代码 到mysql里直接执行即可).</p>
<p>&nbsp;</p>
<p><div id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:f7abadf6-7725-4118-8a16-8b9e66981bed" class="wlWriterEditableSmartContent" style="margin: 0px; display: inline; float: none; padding: 0px;"></div></p>
<p><pre class="brush: java;"></pre></p>
<blockquote>
<p>创建MySql数据库<br><pre class="brush:java"></pre></p>
<p>#创建数据库 htmldatacollection CREATE DATABASE htmldatacollection; #在创建表之前 我们需要使用数据库htmldatacollection use htmldatacollection; #在数据库里 创建一个表 Premiership 用于存储我们收集到的数据 #这里为了方便 所有字段 全部是字符串格式 CREATE TABLE Premiership( Date varchar(15), HomeTeam varchar(20), AwayTeam varchar(20), Result varchar(20) )<br><br>&nbsp;</p>
</blockquote>
<p>创建好后,我们来看看数据库结构.</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012010306153671.jpg" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012010306153671.jpg" alt=""></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<blockquote>
<p>主程序代码<br>数据库弄好了,我们开始实施java代码, 这里简单介绍下各个类以及类所包含的方法.</p>
</blockquote>
<p>DataStorage类 以及包含的 dataStore()方法 用于数据收集和存储</p>
<p>&nbsp;</p>
<p><div id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:56ea0455-039a-4923-b7d3-61499837556c" class="wlWriterEditableSmartContent" style="margin: 0px; display: inline; float: none; padding: 0px;"></div></p>
<p><pre class="brush: java;">DataStorage类</pre></p>
<p>import java.io.BufferedReader;<br>import java.io.IOException;<br>import java.io.InputStreamReader;<br>import java.net.URL;<br>/**</p>
<ul>
<li>DataStorage类 用于数据的收集和存储</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class DataStorage {</p>
<p> public void dataStore() {</p>
<pre><code>// 首先用一个字符串 来装载网页链接
String strUrl = &quot;http://www.footballresults.org/league.php?all=1&amp;amp;league=EngPrem&quot;;

String sqlLeagues = &quot;&quot;;
try {
    // 创建一个url对象来指向 该网站链接 括号里()装载的是该网站链接的路径
    // 更多可以看看 http://wenku.baidu.com/view/8186caf4f61fb7360b4c6547.html
    URL url = new URL(strUrl);
    // InputStreamReader 是一个输入流读取器 用于将读取的字节转换成字符
    // 更多可以看看 http://blog.sina.com.cn/s/blog_44a05959010004il.html
    InputStreamReader isr = new InputStreamReader(url.openStream(),
            &quot;utf-8&quot;); // 统一使用utf-8 编码模式
    // 使用 BufferedReader 来读取 InputStreamReader 转换成的字符
    BufferedReader br = new BufferedReader(isr);
    String strRead = &quot;&quot;; // new 一个字符串来装载 BufferedReader 读取到的内容

    // 定义3个正则 用于获取我们需要的数据
    String regularDate = &quot;(\d{1,2}\.\d{1,2}\.\d{4})&quot;;
    String regularTwoTeam = &quot;&amp;gt;[^&amp;lt;&amp;gt;]*&amp;lt;/a&amp;gt;&quot;;
    String regularResult = &quot;&amp;gt;(\d{1,2}-\d{1,2})&amp;lt;/TD&amp;gt;&quot;;

    //创建 GroupMethod类的对象 gMethod 方便后期调用其类里的 regularGroup方法
    GroupMethod gMethod = new GroupMethod();
    //创建DataStructure数据结构 类的对象   用于数据下面的数据存储
    DataStructure ds = new DataStructure();
    //创建MySql类的对象 用于执行MySql语句
    MySql ms = new MySql();
    int i = 0; // 定义一个i来记录循环次数 即收集到的球队比赛结果数
    int index = 0; // 定义一个索引 用于获取分离 2个球队的数据 因为2个球队正则是相同的
    // 开始读取数据 如果读到的数据不为空 则往里面读
    while ((strRead = br.readLine()) != null) {
        /**
         * 用于捕获日期数据
         */
        String strGet = gMethod.regularGroup(regularDate, strRead);
        // 如果捕获到了符合条件的 日期数据 则打印出来

        if (!strGet.equals(&quot;&quot;)) {
            //System.out.println(&quot;Date:&quot; + strGet);
            //将收集到的日期存在数据结构里
            ds.date = strGet;
            // 这里索引+1 是用于获取后期的球队数据
            ++index; // 因为在html页面里 源代码里 球队数据是在刚好在日期之后
        }
        /**
         * 用于获取2个球队的数据
         */
        strGet = gMethod.regularGroup(regularTwoTeam, strRead);
        if (!strGet.equals(&quot;&quot;) &amp;amp;&amp;amp; index == 1) { // 索引为1的是主队数据
            // 通过subtring方法 分离出 主队数据
            strGet = strGet.substring(1, strGet.indexOf(&quot;&amp;lt;/a&amp;gt;&quot;));
            //System.out.println(&quot;HomeTeam:&quot; + strGet); // 打印出主队
            //将收集到的主队名称 存到 数据结构里
            ds.homeTeam = strGet;
            index++; // 索引+1之后 为2了
            // 通过subtring方法 分离出 客队
        } else if (!strGet.equals(&quot;&quot;) &amp;amp;&amp;amp; index == 2) { // 这里索引为2的是客队数据
            strGet = strGet.substring(1, strGet.indexOf(&quot;&amp;lt;/a&amp;gt;&quot;));
            //System.out.println(&quot;AwayTeam:&quot; + strGet); // 打印出客队
            //将收集到的客队名称 存到数据结构里
            ds.awayTeam = strGet;
            index = 0;  //收集完客队名称后 需要将索引还原 用于收集下一条数据的主队名称
        }
        /**
         * 用于获取比赛结果
         */
        strGet = gMethod.regularGroup(regularResult, strRead);
        if (!strGet.equals(&quot;&quot;)) {
            // 这里同样用到了substring方法 来剔除&apos;&amp;lt;&apos; 和 &quot;&amp;lt;/TD&amp;gt;&quot; 标签 来获取我们想要的比赛结果
            strGet = strGet.substring(1, strGet.indexOf(&quot;&amp;lt;/TD&amp;gt;&quot;));
            //System.out.println(&quot;Result:&quot; + strGet);
            ds.result = strGet; //将收集到的比赛结果存到数据结构里
            //System.out.println();

            //MySql插入语句
            sqlLeagues = &quot;INSERT INTO Premiership values(&quot;&quot;
                    + ds.date + &quot;&quot;,&quot; + &quot;&quot;&quot; + ds.homeTeam
                    + &quot;&quot;,&quot; + &quot;&quot;&quot; + ds.awayTeam + &quot;&quot;,&quot;+ &quot;&quot;&quot; + ds.result + &quot;&quot;)&quot;;
            //调用MySql类的datatoMySql()方法 来执行 MySql插入语句
            ms.datatoMySql(sqlLeagues);
            i++; //每插入完一条记录 i+1;
            System.out.println(&quot;第&quot;+i+&quot;条数据插入成功&quot;);
        }
    }
    // 当读完数据后 记得关闭 BufferReader
    br.close();
    //System.out.println(&quot;共收集到&quot; + i + &quot;条比赛记录&quot;);// 打印出循环次数
    //当数据存储完成后 打印出 收集球队记录数
    System.out.println(&quot;数据存储完毕,共插入数据库&quot;+i+&quot;条记录&quot;);
} catch (IOException e) {
    // 如果出错 抛出异常
    e.printStackTrace();
}
</code></pre><p> }<br>}<br></p>
<blockquote>
<p>DataStructure类<br>简单数据结构 里面包含了相应的字段  用于将收集的数据临时性存储</p>
</blockquote>
</li>
</ul>
<p>&nbsp;</p>
<p><div id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:119d2fda-275d-4eec-be0e-b18e591a3119" class="wlWriterEditableSmartContent" style="margin: 0px; display: inline; float: none; padding: 0px;"></div></p>
<p><pre class="brush: java;">DataStructure 类</pre></p>
<p>/**</p>
<ul>
<li>DataStructure 类 一个简单的数据结构</li>
<li>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class DataStructure {<br> //定义数据字段<br> public String homeTeam;<br> public String awayTeam;<br> public String date;<br> public String result;<br>}<br><blockquote>
<p>GroupMethod类<br>以及包含的  regularGroup()方法 用于正则匹配html 源代码上的数据<br><div id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:ffe87080-7399-4c7e-b894-dd6977e64aae" class="wlWriterEditableSmartContent" style="margin: 0px; display: inline; float: none; padding: 0px;"><br><pre class="brush: java;">GroupMethod 类</pre></div></p>
</blockquote>
</li>
</ul>
<p>import java.util.regex.Matcher;<br>import java.util.regex.Pattern;<br>/**</p>
<ul>
<li>GroupMethod 类 用于匹配和抓取 html页面的数据</li>
<li>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class GroupMethod {<br> // 传入2个字符串参数 一个是pattern(我们使用的正则) 另一个matcher是html源代码<br> public String regularGroup(String pattern, String matcher) {<pre><code>Pattern p = Pattern.compile(pattern, Pattern.CASE_INSENSITIVE);
Matcher m = p.matcher(matcher);
if (m.find()) { // 如果读到
    return m.group();// 返回捕获的数据
} else {
    return &quot;&quot;; // 否则返回一个空字符串
}
</code></pre> }<br>}<br><blockquote>
<p>MySql类<br>以及包含的 datatoMySql() 方法 用于执行SQL插入语句 将临时存储在数据结构里的数据 插入到MySql数据库中</p>
</blockquote>
</li>
</ul>
<p>&nbsp;</p>
<p><div id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:f73657fb-6b65-48c0-9bfe-2b53360d5064" class="wlWriterEditableSmartContent" style="margin: 0px; display: inline; float: none; padding: 0px;"></div></p>
<p><pre class="brush: java;">MySql类</pre></p>
<p>import java.sql.Connection;<br>import java.sql.DriverManager;<br>import java.sql.SQLException;<br>import java.sql.Statement;</p>
<p>/**</p>
<ul>
<li>MySql类用于实施MySql数据库操作</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class MySql {</p>
<p> //定义MySql驱动,数据库地址,数据库用户名 密码, 执行语句和数据库连接<br> public String driver = “com.mysql.jdbc.Driver”;<br> public String url = “jdbc:mysql://127.0.0.1:3306/htmldatacollection”;<br> public String user = “root”;<br> public String password = “root”;<br> public Statement stmt = null;<br> public Connection conn = null;</p>
<p> //创建一个插入数据的方法<br> public void datatoMySql(String insertSQl) {</p>
<pre><code>try {
    try {
        Class.forName(driver).newInstance();
    } catch (Exception e) {
        System.out.println(&quot;Unable to find the local driver&quot;);
        e.printStackTrace();
    }
    //创建连接
    conn = DriverManager.getConnection(url, user, password);
    //创建一个 Statement 对象来将 SQL 语句发送到数据库
    stmt = conn.createStatement();
} catch (SQLException e) {
    e.printStackTrace();
}
try {
    //执行SQL 插入语句
    stmt.executeUpdate(insertSQl);
} catch (SQLException e) {
    e.printStackTrace();
}
try {
    //执行完 停止执行语句
    stmt.close();
    //执行完关闭数据库连接
    conn.close();
} catch (SQLException e) {
    e.printStackTrace();
}
</code></pre><p> }<br>}<br><br>&nbsp;</p>
</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<!--nextpage-->
<blockquote>
<p>Main 主函数<br>用于数据输出</p>
</blockquote>
<p>&nbsp;</p>
<p><div id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:4576f470-ad65-4718-a7e6-efaa4b2c5052" class="wlWriterEditableSmartContent" style="margin: 0px; display: inline; float: none; padding: 0px;"></div></p>
<p><pre class="brush: java;">Main 主函数</pre></p>
<p>/**</p>
<ul>
<li>Main 主函数 用于数据输出</li>
<li>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class Main {<br> public static void main(String[] args) {<pre><code> //在主函数里调用DataStorage类里的dataStore()方法
DataStorage ds = new DataStorage();
ds.dataStore();
</code></pre> }<br>}<br><br>运行查看<br>好了,下面我们来执行下 看看结果.</li>
</ul>
<p>数据采集页面 <a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">2011-2012赛季英超球队战绩</a></p>
<p>Html页面截图-初始阶段</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012010306300784.jpg" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012010306300784.jpg" alt=""></a></p>
<p>MySql数据库截图-初始阶段</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012010306294412.jpg" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012010306294412.jpg" alt=""></a></p>
<p>Html页面截图-结束阶段</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012010306465849.jpg" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012010306465849.jpg" alt=""></a></p>
<p>MySql数据库截图-结束阶段</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012010306304481.jpg" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012010306304481.jpg" alt=""></a></p>
<p>一共收集到 189条记录</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012010306340918.jpg" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012010306340918.jpg" alt=""></a></p>
<p>MySql数据库显示 189 行数据</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012010306334152.jpg" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012010306334152.jpg" alt=""></a></p>
<p>这样,我们2011-2012英超联盟赛季的比赛战绩就全部收集并存到MySql数据库里了.  :)</p>
<p><a href="http://files.cnblogs.com/longwu/htmlDataStorage.zip" target="_blank" rel="external">附上源代码下载   点击打开链接</a></p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/20/webpage-data-collector-1/" itemprop="url">
                  Java网页数据采集器[上篇-数据采集]
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-20T00:00:11+08:00" content="2014-02-20">
              2014-02-20
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 3,608</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 17分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-SE/" itemprop="url" rel="index">
                    <span itemprop="name">Java SE</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/20/webpage-data-collector-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/20/webpage-data-collector-1/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>开篇  </p><p>作为全球运用最广泛的语言,Java 凭借它的高效性,可移植性(跨平台),代码的健壮性以及强大的可扩展性,深受广大应用程序开发者的喜爱. 作为一门强大的开发语言,正则表达式在其中的应用当然是必不可少的,而且正则表达式的掌握能力也是那些高级程序员的开发功底之体现,做一名合格的网站开发的程序员(尤其是做前端开发),正则表达式是必备的.  </p><p>最近,由于一些需要,用到了java和正则,做了个的<a href="http://www.footballresults.org/" target="_blank" rel="external">足球网站</a>的数据采集程序;由于是第一次做关于java的html页面数据采集,必然在网上查找了很多资料,但是发现运用如此广泛的java在使用正则做html采集方面的(中文)文章是少之又少,都是简单的谈了下java正则的概念,没有真正用在实际网页html采集,实例教程更是寥寥无几(虽然java有它自己的Html Parser,而且十分强大),但个人觉得作为如此深入人心的正则表达式,理应有其相关的java实例教程,而且应该很多很全.于是在完成java版的html数据采集程序之后,本人便打算写个关于正则表达式在java上的html页面采集,以便有相关兴趣的读者更好的学习.  </p><p>本期概述  </p><p>这期我们来学习下如何读取网页源代码，并通过group正则 动态抓取我们需要的网页数据.同时在接下来的几期,我们将继续学习<a href="http://www.cnblogs.com/longwu/archive/2012/01/03/2310588.html" target="_blank" rel="external">[数据存储]</a>如何将抓取的比赛数据存到数据库(MySql), [数据查询] 怎样查询我们想看的比赛记录,以及[远程操作]通过客户端远程访问和操作服务器来进行数据的采集,存储和查询.  </p><p>关于group正则&nbsp; </p><p>说到正则表达式是如何帮助java进行html页面采集,这里需要提一下正则表达式中的group方法(代码如下).<br> <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:8ceac024-75e3-4e08-89c3-9adad1d990c3" class="wlWriterEditableSmartContent"><pre class="brush: java;">import java.util.regex.Matcher;<br>import java.util.regex.Pattern;<br>/**</pre></div></p>
<ul>
<li>Group 类 用于匹配和抓取 html页面的数据</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class Group {</p>
<p>  public static void main(String[] args) {</p>
<pre><code>// Pattern 用于编译正则 这里用到了3个正则 分别用括号()包住
// 第1个正则用于匹配URL 当然这里的正则不一定准确 这个匹配URL的正则就是错误的 只是在这里刚好能匹配出来
// 第2个正则是用于匹配标题 SoFlash的
// 第3个正则用于匹配日期
/* 这里只用了一条语句便把url,标题和日期全部给匹配出来了 */
Pattern p = Pattern
        .compile(&quot;=&apos;(\w.+)&apos;&amp;gt;(\w.+[a-zA-Z])-(\d{1,2}\.\d{1,2}\.\d{4})&quot;);
String s = &quot;&amp;lt;a href=&apos;http://www.cnblogs.com/longwu&apos;&amp;gt;SoFlash-12.22.2011&amp;lt;/a&amp;gt;&quot;;
Matcher m = p.matcher(s);
while (m.find()) {
    // 通过调用group()方法里的索引 将url,标题和日期全部给打印出来
    System.out.println(&quot;打印出url链接:&quot; + m.group(1));
    System.out.println(&quot;打印出标题:&quot; + m.group(2));
    System.out.println(&quot;打印出日期:&quot; + m.group(3));
    System.out.println();
}
System.out.println(&quot;group方法捕获的数据个数:&quot; + m.groupCount() + &quot;个&quot;);
</code></pre><p>  }<br>}</p>
</li>
</ul>
<p><strong>我们看下输出结果:</strong> </p>
<p></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 打印出url链接:<a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 打印出标题:SoFlash<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 打印出日期:12.22.2011 </p>
<p></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; group方法捕获的数据个数:3个 </p>
<p></p><p>&nbsp; </p><p><strong>想了解更多的正则在java方面应用的朋友请看</strong> <a href="http://blog.csdn.net/allwefantasy/article/details/3136570" target="_blank" rel="external">JAVA 正则表达式 （超详细）</a> </p>
<p></p><p><strong>如果之前没有学过正则的可以看看这个</strong> <a href="http://www.regexlab.com/zh/regref.htm" target="_blank" rel="external">揭开正则表达式的神秘面纱</a> </p>
<p></p><p>&nbsp; </p><p>&nbsp; </p><p><strong>页面采集实例 </strong></p>
<p></p><p>好了 group方法介绍完了 我们来使用下group正则采集某个足球网站页面的数据 </p>
<p></p><p>页面链接: <a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">2011-2012赛季英超球队战绩</a> </p>
<p></p><p>首先我们读取整个html页面,并打印出来(代码如下). </p>
<p></p><p>&nbsp; </p><p>&nbsp;</p>
<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:7baae208-bf56-4d82-81dd-8ab401a08662" class="wlWriterEditableSmartContent"><pre class="brush: java;">public static void main(String[] args) {<br><br>         String strUrl = “<a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">http://www.footballresults.org/league.php?all=1&amp;league=EngPrem</a>“;<br>         try {<br>             // 创建一个url对象来指向 该网站链接 括号里()装载的是该网站链接的路径<br>             // 更多可以看看 <a href="http://wenku.baidu.com/view/8186caf4f61fb7360b4c6547.html" target="_blank" rel="external">http://wenku.baidu.com/view/8186caf4f61fb7360b4c6547.html</a><br>             URL url = new URL(strUrl);<br>             // InputStreamReader 是一个输入流读取器 用于将读取的字节转换成字符<br>             // 更多可以看看 <a href="http://blog.sina.com.cn/s/blog_44a05959010004il.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_44a05959010004il.html</a><br>             InputStreamReader isr = new InputStreamReader(url.openStream(),<br>                     “utf-8”); // 统一使用utf-8 编码模式<br>             // 使用 BufferedReader 来读取 InputStreamReader 转换成的字符<br>             BufferedReader br = new BufferedReader(isr);<br>             // 如果 BufferedReader 读到的内容不为空<br>             while (br.readLine() != null) {<br>                 // 则打印出来 这里打印出来的结果 应该是整个网站的<br>                 System.out.println(br.readLine());<br>             }<br>             br.close(); // 读取完成后关闭读取器<br>         } catch (IOException e) {<br>             // 如果出错 抛出异常<br>             e.printStackTrace();<br>         }<br>     }</pre></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>打印出来的结果是整个html页面的源代码(部分截图如下).</p>
<p>&nbsp;</p>
<p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122410242795.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122410242795_thumb.jpg" alt="2011122410242795" title="2011122410242795"></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>到这里,html源代码已经成功采集下来了.但是,我们想要的并不是整个html源代码, 而是网页上的比赛数据.<br><!--nextpage--></p>
<p></p><p>首先,我们分析下 html源代码结构 来到 <a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">2011-2012赛季英超球队战绩</a> 页面,右键 点击 ‘查看源文件’ (其它浏览器可能叫源代码或者相关). </p>
<p></p><p>&nbsp; </p><p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122410461575.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122410461575_thumb.jpg" alt="2011122410461575" title="2011122410461575"></a> </p>
<p></p><p>我们来看看 其内部的html代码结构 以及我们需要的数据. </p>
<p></p><p>&nbsp; </p><p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122410585736.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122410585736_thumb.jpg" alt="2011122410585736" title="2011122410585736"></a> </p>
<p></p><p>&nbsp; </p><p>其对应的页面数据 </p>
<p></p><p>&nbsp; </p><p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122409395913.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122409395913_thumb.jpg" alt="2011122409395913" title="2011122409395913"></a> </p>
<p></p><p>&nbsp; </p><p>这时候,强大的正则表达式派上用场了, 我们需要写几个用来抓取球队数据的正则. </p>
<p></p><p>这里需要用到3个正则表达式: 日期正则,2个球队正则(主队和客队)以及比赛结果正则. </p>
<p></p><p>String regularDate = “(\d{1,2}.\d{1,2}.\d{4})”;&nbsp;&nbsp; //日期正则<br>String regularTwoTeam = “&gt;[^&lt;&gt;]*&lt;/a&gt;”;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //球队正则<br>String regularResult = “&gt;(\d{1,2}-\d{1,2})&lt;/TD&gt;”;&nbsp;&nbsp;&nbsp; //比赛结果正则 </p>
<p></p><p>写好正则, 我们便可以使用该正则来抓取我们想要得到的数据了. </p>
<p></p><p>首先,我们写一个GroupMethod类, 里面包含了regularGroup()方法,用于抓取html页面数据. </p>
<p></p><p>&nbsp; </p><p>&nbsp;</p>
<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:1a1f6a39-b644-4349-b9d9-877085498638" class="wlWriterEditableSmartContent"><pre class="brush: java;">import java.util.regex.Matcher;<br>import java.util.regex.Pattern;<br>/<em>*
 </em> GroupMethod类 用于匹配并抓去 Html上我们想要的内容<br> <em> @author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a>
 </em>/<br>public class GroupMethod {<br>    // 传入2个字符串参数 一个是pattern(我们使用的正则) 另一个matcher是html源代码<br>    public String regularGroup(String pattern, String matcher) {<br>        Pattern p = Pattern.compile(pattern, Pattern.CASE_INSENSITIVE);<br>        Matcher m = p.matcher(matcher);<br>        if (m.find()) { // 如果读到<br>            return m.group();// 返回捕获的数据<br>        } else {<br>            return “”; // 否则返回一个空字符串<br>        }<br>    }<br>}</pre></div>

<p>&nbsp; </p><p>然后在主函数里实施html页面的数据抓取. </p>
<!--nextpage-->
<p></p><p>&nbsp; </p><p>&nbsp;</p>
<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:b9537a5f-dc22-4c49-89e5-0bc4c7b42cd8" class="wlWriterEditableSmartContent"><pre class="brush: java;">import java.io.BufferedReader;<br>import java.io.IOException;<br>import java.io.InputStreamReader;<br>import java.net.URL;<br>/<strong><br> <em> Main主函数 用于数据采集
 </em> @author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br> <em>/<br>public class Main {<br><br>    public static void main(String[] args) {<br>        // 首先用一个字符串 来装载网页链接<br>        String strUrl = “<a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">http://www.footballresults.org/league.php?all=1&amp;league=EngPrem</a>“;<br>        try {<br>            // 创建一个url对象来指向 该网站链接 括号里()装载的是该网站链接的路径<br>            // 更多可以看看 <a href="http://wenku.baidu.com/view/8186caf4f61fb7360b4c6547.html" target="_blank" rel="external">http://wenku.baidu.com/view/8186caf4f61fb7360b4c6547.html</a><br>            URL url = new URL(strUrl);<br>            // InputStreamReader 是一个输入流读取器 用于将读取的字节转换成字符<br>            // 更多可以看看 <a href="http://blog.sina.com.cn/s/blog_44a05959010004il.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_44a05959010004il.html</a><br>            InputStreamReader isr = new InputStreamReader(url.openStream(),<br>                    “utf-8”); // 统一使用utf-8 编码模式<br>            // 使用 BufferedReader 来读取 InputStreamReader 转换成的字符<br>            BufferedReader br = new BufferedReader(isr);<br>            String strRead = “”; // 新增一个空字符串strRead来装载 BufferedReader 读取到的内容<br><br>            // 定义3个正则 用于匹配我们需要的数据<br>            String regularDate = “(\d{1,2}.\d{1,2}.\d{4})”;<br>            String regularTwoTeam = “&gt;[^&lt;&gt;]</em>&lt;/a&gt;”;<br>            String regularResult = “&gt;(\d{1,2}-\d{1,2})&lt;/TD&gt;”;<br><br>            // 创建一个GroupMethod类的对象 gMethod 方便后期调用其类里的 regularGroup方法<br>            GroupMethod gMethod = new GroupMethod();<br>            int i =0;  //定义一个i来记录循环次数  即收集到的球队比赛结果数<br>            int index = 0; // 定义一个索引 用于获取分离 2个球队的数据 因为2个球队正则是相同的<br>            // 开始读取数据 如果读到的数据不为空 则往里面读<br>            while ((strRead = br.readLine()) != null) {<br>                /</strong><br>                 <em> 用于捕获日期数据
                 </em>/<br>                String strGet = gMethod.regularGroup(regularDate, strRead);<br>                //如果捕获到了符合条件的 日期数据 则打印出来<br>                if (!strGet.equals(“”)) {<br>                    System.out.println(“Date:” + strGet);<br>                    //这里索引+1  是用于获取后期的球队数据<br>                    ++index;   //因为在html页面里 源代码里 球队数据是在刚好在日期之后<br>                }<br>                /<strong><br>                 <em> 用于获取2个球队的数据
                 </em>/<br>                strGet = gMethod.regularGroup(regularTwoTeam, strRead);<br>                if (!strGet.equals(“”) &amp;&amp; index == 1) { //索引为1的是主队数据<br>                    // 通过substring方法 分离出 主队数据<br>                    strGet = strGet.substring(1, strGet.indexOf(“&lt;/a&gt;”));<br>                    System.out.println(“HomeTeam:” + strGet); //打印出主队<br>                    index++;  //索引+1之后 为2了<br>                    // 通过substring方法 分离出 客队<br>                } else if (!strGet.equals(“”) &amp;&amp; index == 2) {  //这里索引为2的是客队数据<br>                    strGet = strGet.substring(1, strGet.indexOf(“&lt;/a&gt;”));<br>                    System.out.println(“AwayTeam:” + strGet); //打印出客队<br>                    index = 0;<br>                }<br>                /</strong><br>                 <em> 用于获取比赛结果
                 </em>/<br>                strGet = gMethod.regularGroup(regularResult, strRead);<br>                if (!strGet.equals(“”)) {<br>                    //这里同样用到了substring方法 来剔除’&lt;’ 和 “&lt;/TD&gt;” 标签 来获取我们想要的比赛结果<br>                    strGet = strGet.substring(1, strGet.indexOf(“&lt;/TD&gt;”));<br>                    System.out.println(“Result:” + strGet);<br>                    System.out.println();<br>                    i++;<br>                }<br>            }<br>            // 当读完数据后 记得关闭 BufferReader<br>            br.close();<br>            System.out.println(“共收集到”+i+”条比赛记录”);//打印出循环次数<br>        } catch (IOException e) {<br>            // 如果出错 抛出异常<br>            e.printStackTrace();<br>        }<br>    }<br>}</pre></div>

<p>&nbsp; </p><p>&nbsp; </p><p><strong>运行查看</strong> </p>
<p></p><p>我们来看看输出结果(部分截图-初始阶段) </p>
<p></p><p>&nbsp; </p><p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122410261729.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122410261729_thumb.jpg" alt="2011122410261729" title="2011122410261729"></a> </p>
<!--nextpage-->
<p></p><p>&nbsp; </p><p>对比下 html上的数据 (部分截图-初始阶段) </p>
<p></p><p>&nbsp; </p><p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122508105318.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122508105318_thumb.jpg" alt="2011122508105318" title="2011122508105318"></a> </p>
<p></p><p>&nbsp; </p><p>输出结果(部分截图-结束阶段) </p>
<p></p><p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122508071258.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122508071258_thumb.jpg" alt="2011122508071258" title="2011122508071258"></a> </p>
<p></p><p>对比下 html上的数据 (部分截图-结束阶段) </p>
<p></p><p>&nbsp; </p><p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122508074366.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2011122508074366_thumb.jpg" alt="2011122508074366" title="2011122508074366"></a> </p>
<p></p><p>&nbsp; </p><p>好了, 这样的html数据采集就完成了. :) </p>
<p></p><p>&nbsp; </p><p>当然这里只是抓取了一个页面的内容,如果感兴趣 想抓去更多的页面内容, 你可以分析下该链接后的联盟名, 例如 league=EngPrem&nbsp; </p><p>通过改变league名来获取所有联盟的比赛数据; 你也可以简单写个数组来装载所有的球队名称； </p>
<p></p><p>当然还有更智能的方法, 写个采集数据的方法从<a href="http://www.footballresults.org/allleagues.php" target="_blank" rel="external">http://www.footballresults.org/allleagues.php</a> 页面源代码里获取所有联盟的名字(如下图). </p>
<p></p><p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/2012021401385352.png" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/2012021401385352_thumb.png" alt="2012021401385352" title="2012021401385352"></a> </p>
<p></p><p>然后来附加到 “<a href="http://www.footballresults.org/league.php?all=1&amp;league=" target="_blank" rel="external">http://www.footballresults.org/league.php?all=1&amp;league=</a>“ 链接后面 来补齐链接, 进而循环读取各个联盟比赛页面的内容. </p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/19/java-randomaccessfile/" itemprop="url">
                  Java RandomAccessFile-文件随机读写流
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-19T23:20:34+08:00" content="2014-02-19">
              2014-02-19
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 1,924</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 8分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-SE/" itemprop="url" rel="index">
                    <span itemprop="name">Java SE</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/19/java-randomaccessfile/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/19/java-randomaccessfile/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>RandomAccessFile是一个非常强大的类</p>
<blockquote>
<p>当你需要非常快的修改文件的某些字节的时候，用它绝对能省下99%的时间，因为他不像其他流需要重新写一个临时文件。他是用来访问那些保存数据记录的文件的，你就可以用seek( )方法来访问记录，并进行读写了。这些记录的大小不必相同；但是其大小和位置必须是可知的。但是该类仅限于操作文件。<br>RandomAccessFile不属于InputStream和OutputStream类系的。实际上，除了实现DataInput和DataOutput接口之外(DataInputStream和DataOutputStream也实现了这两个接口)，它和这两个类系毫不相干，甚至不使用InputStream和OutputStream类中已经存在的任何功能；它是一个完全独立的类，所有方法(绝大多数都只属于它自己)都是从零开始写的。这可能是因为RandomAccessFile能在文件里面前后移动，所以它的行为与其它的I/O类有些根本性的不同。<br>总而言之，它是一个直接继承Object的，独立的类。<br>基本上，RandomAccessFile的工作方式是，把DataInputStream和DataOutputStream结合起来，再加上它自己的一些方法，比如定位用的getFilePointer( )，在文件里移动用的seek( )，以及判断文件大小的length( )、skipBytes()跳过多少字节数。此外，它的构造函数还要一个表示以只读方式(“r”)，还是以读写方式(“rw”)打开文件的参数 (和C的fopen( )一模一样)。它不支持只写文件。</p>
</blockquote>
<p>只有RandomAccessFile才有seek搜寻方法，而这个方法也只适用于文件。BufferedInputStream有一个mark( )方法，你可以用它来设定标记(把结果保存在一个内部变量里)，然后再调用reset( )返回这个位置，但是它的功能太弱了，而且也不怎么实用。</p>
<p>RandomAccessFile的绝大多数功能，但不是全部，已经被JDK 1.4的nio的”内存映射文件(memory-mapped files)”给取代了，你该考虑一下是不是用”内存映射文件”来代替RandomAccessFile了。</p>
<p>Demo:</p>
<pre class="brush:java">import java.io.IOException;  
import java.io.RandomAccessFile;  

public class TestRandomAccessFile {  
    public static void main(String[] args) throws IOException {  
    RandomAccessFile rf = new RandomAccessFile("rtest.dat", "rw");  
    for (int i = 0; i &lt; 10; i++) {  
        //写入基本类型double数据  
        rf.writeDouble(i * 1.414);  
    }  
    rf.close();  
    rf = new RandomAccessFile("rtest.dat", "rw");  
    //直接将文件指针移到第5个double数据后面  
    rf.seek(5 * 8);  
    //覆盖第6个double数据  
    rf.writeDouble(47.0001);  
    rf.close();  
    rf = new RandomAccessFile("rtest.dat", "r");  
    for (int i = 0; i &lt; 10; i++) {  
        System.out.println("Value " + i + ": " + rf.readDouble());  
    }  
    rf.close();  
    }  
}</pre>
<pre class="brush:java">import java.io.IOException;  
import java.io.RandomAccessFile;  

public class TestRandomAccessFile {  
    public static void main(String[] args) throws IOException {  
    RandomAccessFile rf = new RandomAccessFile("rtest.dat", "rw");  
    for (int i = 0; i &lt; 10; i++) {  
        //写入基本类型double数据  
        rf.writeDouble(i * 1.414);  
    }  
    rf.close();  
    rf = new RandomAccessFile("rtest.dat", "rw");  
    //直接将文件指针移到第5个double数据后面  
    rf.seek(5 * 8);  
    //覆盖第6个double数据  
    rf.writeDouble(47.0001);  
    rf.close();  
    rf = new RandomAccessFile("rtest.dat", "r");  
    for (int i = 0; i &lt; 10; i++) {  
        System.out.println("Value " + i + ": " + rf.readDouble());  
    }  
    rf.close();  
    }  
}</pre>
非常详细的例子Demo:见下页
<!--nextpage-->

<pre class="brush:java">
import java.io.FileNotFoundException;  
import java.io.IOException;  
import java.io.RandomAccessFile;  
class Student  
{  
private String name;  
private int age;  
public Student() {  
super();  
}  
public int getAge() {  
return age;  
}  
public void setAge(int age) {  
this.age = age;  
}  
public String getName() {  
return name;  
}  
public void setName(String name) {  
this.name = name;  
}  
public Student(String name, int age) {  
super();  
this.name = name;  
this.age = age;  
}  
}  
public class UseIO {  
public static void main(String[] args)  
{  
RandomAccessFile randomAccessFile=null;  
try {  
//创建一个随机访问文件对象,并设置为可读写模式  
randomAccessFile=new RandomAccessFile("src\bean\newFile.txt","rw");  
System.out.println("文件指针当前位置:"+randomAccessFile.getFilePointer());  

//添加内容到文件中去  
//使用writeChars方法把一串字符写到文件中  
//randomAccessFile.writeChars("I am here!If you love me,please give the kiss to me!nThank you for your love!");  

//使用writeBytes方法把一串字符写到文件中,使用该方法将会被舍弃字符中的高8位,所以实际上写入的是字符中的低8位.  
randomAccessFile.writeBytes("I am here!If you love me,please give the kiss to me!nThank you for your love!");  
System.out.println("使用readLine方法读取数据:");  

System.out.println("此时文件指针当前位置:"+randomAccessFile.getFilePointer());  

//重新把文件指针定位到开始处  
randomAccessFile.seek(0);  

//使用readLine读取文件内容,每个字节的值被转换为字符的低8位,而字符的高8位被赋予0.因此这个方法不支持unicode字符集.  
String content=randomAccessFile.readLine();  
while(content!=null)  
{  
System.out.println(content);  
content=randomAccessFile.readLine();  
}  

//使用read方法读取指定长度的字节  
//重新把文件指针定位到开始处  
randomAccessFile.seek(0);  

byte[] b=new byte[10];  
int length=randomAccessFile.read(b);  
System.out.println("真正读取的字节数:"+length);  

//使用当前平台当前的默认字符集把字节数组转换为字符  
String convertStr=new String(b);  
System.out.println("转换后的内容为:"+convertStr);  

//使用skipBytes跳过若干个字节后,读取后面的字节  
//重新把文件指针定位到开始处  
randomAccessFile.seek(0);  
length=randomAccessFile.skipBytes(10);//参数可以为负数,当为负数时,则该方法不起作用  
System.out.println("实际跳过的字节数:"+length);  
content=randomAccessFile.readLine();  
while(content!=null)  
{  
System.out.println(content);  
content=randomAccessFile.readLine();  
}  

//之前使用writeBytes写入内容,所以如果我们使用readChar读取内容中的一个字符时,可能将出错  
//出现乱码的原因在于,使用该方法将从文件中读取两个字节做为一个字符高8位和低8位,作为一个unicode字符  
//重新把文件指针定位到开始处  
randomAccessFile.seek(0);  
char c=randomAccessFile.readChar();  
System.out.println("读取一个字符:"+c);  
System.out.println("读取的这个字符的值为:"+(int)c);  

//设置文件的内容为0字节  
randomAccessFile.setLength(0);  
//注意使用UTF格式写入字符串时,对于英文字符,则占一个字节,中文字符,占三个字节,  
//而且当使用writeUTF时,在文件的开始处将写入整个字节的长度(注意不是字符串长度),占两个字节  
randomAccessFile.writeUTF("我爱你!i love you!");  
//重新把文件指针定位到开始处  
randomAccessFile.seek(0);  
System.out.println(randomAccessFile.readUTF());  
System.out.println("使用writeUTF方法写入字符串时,文件字节长度为:"+randomAccessFile.length());  

//设置文件的内容为0字节  
randomAccessFile.setLength(0);  
//创建两个学生记录,并写入文件中  
Student[] studs=new Student[]{new Student("andy",23),new Student("lili",22)};  

for(Student stud:studs)  
{  
randomAccessFile.writeUTF(stud.getName());  
randomAccessFile.writeInt(stud.getAge());  
}  

//读取刚才写入的内容  
//重新把文件指针定位到开始处  
randomAccessFile.seek(0);  
//创建学生记录:  
Student[] studCreated=new Student[2];
for(int i=0;i< studCreated.length;i++)  
{  
studCreated[i]=new Student();  
studCreated[i].setName(randomAccessFile.readUTF());  
studCreated[i].setAge(randomAccessFile.readInt());  

System.out.println("第"+i+"位学生的记录:");  
System.out.println("name:"+studCreated[i].getName());  
System.out.println("age:"+studCreated[i].getAge());  
}  
} catch (FileNotFoundException e) {  
// TODO Auto-generated catch block  
e.printStackTrace();  
} catch (IOException e) {  
// TODO Auto-generated catch block  
e.printStackTrace();  
}finally{  
try {  
randomAccessFile.close();  
} catch (IOException e) {  
// TODO Auto-generated catch block  
e.printStackTrace();  
}  
}  
}  
}  

</pre>

<p></p>
<pre class="brush:java"></pre>

<p>这个例子需要注意的是UTF对中文字符的处理以及使用writeBytes方法与writeChars方法的区别.<br>运行后的结果为：<br>文件指针当前位置:0<br>使用readLine方法读取数据:<br>此时文件指针当前位置:77<br>I am here!If you love me,please give the kiss to me!<br>Thank you for your love!<br>真正读取的字节数:10<br>转换后的内容为:I am here!<br>实际跳过的字节数:10<br>If you love me,please give the kiss to me!<br>Thank you for your love!<br>读取一个字符:?<br>读取的这个字符的值为:18720<br>我爱你!i love you!<br>使用writeUTF方法写入字符串时,文件字节长度为:23</p>
<p>第0位学生的记录:<br>name:andy<br>age:23</p>
<p>第1位学生的记录:<br>name:lili<br>age:22<br>此时newFile.txt中的内容为:andy lili</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/19/java-swing-drog/" itemprop="url">
                  java-swing文件拖拽路径识别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-19T23:00:00+08:00" content="2014-02-19">
              2014-02-19
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 253</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 1分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-SE/" itemprop="url" rel="index">
                    <span itemprop="name">Java SE</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/19/java-swing-drog/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/19/java-swing-drog/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>文件拖拽识别是非常常用也非常实用的一个小功能</p>
</blockquote>
<p>日常的应用如果需要操作到文件，每一次都用浏览文件来添加的话是非常麻烦的，而下面这种方法则可以用文件的拖拽来获取路径</p>
<p>主要是用到了DropTargetAdapter类，源代码如下：</p>
<pre class="brush:java">
import java.awt.event.*;
import java.awt.dnd.*;
import java.awt.datatransfer.*;
import javax.swing.*;
import java.util.*;
import java.io.File;
public class JavaFileDragDrop extends JFrame
{
    JTextArea jta;
    public JavaFileDragDrop()
    {
        this.setTitle("java file drag and drop test");
        this.setBounds(150,150,300,300);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.setLayout(null);
        jta=new JTextArea();

        DropTargetAdapter kgd=new DropTargetAdapter()
        {
            public void drop(DropTargetDropEvent dtde)
            {
                try
                {
                    Transferable tf=dtde.getTransferable();
                    if(tf.isDataFlavorSupported(DataFlavor.javaFileListFlavor))
                    {
                        dtde.acceptDrop(DnDConstants.ACTION_COPY_OR_MOVE);
                        List lt=(List)tf.getTransferData(DataFlavor.javaFileListFlavor);
                        Iterator itor=lt.iterator();
                        while(itor.hasNext())
                        {
                            File f=(File)itor.next();
                            jta.setText(jta.getText()+"n"+f.getAbsolutePath());
                        }
                        dtde.dropComplete(true);
                     }
                     else
                     {
                        dtde.rejectDrop();
                     }
                 }
                 catch(Exception e)
                 {
                     e.printStackTrace();
                 }
              }
        };

        new DropTarget(jta,DnDConstants.ACTION_COPY_OR_MOVE,kgd);

        jta.setBounds(30,30,250,250);
        this.add(jta);
        this.setVisible(true);
    }
    public static void main(String[] args)
    {
        new JavaFileDragDrop();
    }
}
</pre>

<p>如果Copy请回复支持一下，谢谢！</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/18/java-qq-prompt-message/" itemprop="url">
                  Java实现屏幕右下角弹出类QQ提示消息
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-18T23:57:31+08:00" content="2014-02-18">
              2014-02-18
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 1,498</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 8分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-SE/" itemprop="url" rel="index">
                    <span itemprop="name">Java SE</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/18/java-qq-prompt-message/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/18/java-qq-prompt-message/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;<br>利用java swing 实现如QQ提示消息的效果：<br>效果图：</p>
<p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/qq-msg-util-1.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/qq-msg-util-1-300x253.jpg" alt="qq-msg-util-1"></a></p>
<p>&nbsp;</p>
<p>java代码调用实例：</p>
<p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/qq-msg-util-2.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/qq-msg-util-2-300x245.jpg" alt="qq-msg-util-2"></a></p>
<p>&nbsp;</p>
<p>源代码：</p>
<p>&nbsp;</p>
<div id="scid:f32c3428-b7e9-4f15-a8ea-c502c7ff2e88:a5b71b4a-5460-4acf-aa14-dcde6b2275da" class="wlWriterEditableSmartContent" style="margin: 0px; display: inline; float: none; padding: 0px;"><br><pre class="brush: java;collapse:true;">import java.awt.BorderLayout;<br>import java.awt.Color;<br>import java.awt.Cursor;<br>import java.awt.Dimension;<br>import java.awt.FlowLayout;<br>import java.awt.Font;<br>import java.awt.Point;<br>import java.awt.event.MouseAdapter;<br>import java.awt.event.MouseEvent;<br>import java.awt.event.MouseMotionAdapter;<br>import java.text.SimpleDateFormat;<br>import java.util.Date;<br>import javax.swing.BorderFactory;<br>import javax.swing.ImageIcon;<br>import javax.swing.JLabel;<br>import javax.swing.JOptionPane;<br>import javax.swing.JPanel;<br>import javax.swing.JScrollPane;<br>import javax.swing.JTextArea;<br>import javax.swing.SwingConstants;<br>import java.awt.Insets;<br>import java.awt.Toolkit;<br>import javax.swing.JDialog;<br><br>/<em>*
 </em> @author Administrator<br> <em>    此工具类用法：实例化出对象，调用 void show(“标题”,”内容”) 方法.
 </em>    InfoUtil tool = new InfoUtil();<br> <em>    tool.show(“标题”,”内容”)
 </em>/<br>public class InfoUtil {<br>    private Point oldP;                                        // 上一次坐标,拖动窗口时用<br>    private TipWindow tw = null;                            // 提示框<br>    private ImageIcon img = null;                            // 图像组件<br>    private JLabel imgLabel = null;                         // 背景图片标签<br>    private JPanel headPan = null;<br>    private JPanel feaPan = null;<br>    private JPanel btnPan = null;<br>    private JLabel title = null;                            // 栏目名称<br>    private JLabel head = null;                                // 蓝色标题<br>    private JLabel close = null;                            // 关闭按钮<br>    private JTextArea feature = null;                        // 内容<br>    private JScrollPane jfeaPan = null;<br>    private JLabel releaseLabel = null;                        //发布时间<br>    private JLabel sure = null;<br>    private String titleT = null;<br>    private String word = null;<br>    private String time = null;<br>    private SimpleDateFormat sdf =<br>            new SimpleDateFormat(“yyyy-MM-dd HH:mm:ss”);<br><br>    public void init() {<br>        // 新建300x220的消息提示框<br>        tw = new TipWindow(300, 220);<br>        img = new ImageIcon(“background.gif”);<br>        imgLabel = new JLabel(img);<br>        // 设置各个面板的布局以及面板中控件的边界<br>        headPan = new JPanel(new FlowLayout(FlowLayout.CENTER, 0, 0));<br>        feaPan = new JPanel(new FlowLayout(FlowLayout.CENTER, 0, 0));<br>        btnPan = new JPanel(new FlowLayout(FlowLayout.CENTER, 0, 0));<br>        title = new JLabel(“欢迎使用本系统”);<br>        head = new JLabel(titleT);<br>        close = new JLabel(“ x”);<br>        feature = new JTextArea(word);<br>        jfeaPan = new JScrollPane(feature);<br>        releaseLabel = new JLabel(“发布于  “ + time);<br>        sure = new JLabel(“确定”);<br>        sure.setHorizontalAlignment(SwingConstants.CENTER);<br><br>        // 将各个面板设置为透明，否则看不到背景图片<br>        ((JPanel) tw.getContentPane()).setOpaque(false);<br>        headPan.setOpaque(false);<br>        feaPan.setOpaque(false);<br>        btnPan.setOpaque(false);<br><br>        // 设置JDialog的整个背景图片<br>        tw.getLayeredPane().add(imgLabel, new Integer(Integer.MIN_VALUE));<br>        imgLabel.setBounds(0, 0, img.getIconWidth(), img.getIconHeight());<br>        headPan.setPreferredSize(new Dimension(300, 60));<br><br>        // 设置提示框的边框,宽度和颜色<br>        tw.getRootPane().setBorder(<br>                BorderFactory.createMatteBorder(1, 1, 1, 1, Color.gray));<br>        title.setPreferredSize(new Dimension(260, 26));<br>        title.setVerticalTextPosition(JLabel.CENTER);<br>        title.setHorizontalTextPosition(JLabel.CENTER);<br>        title.setFont(new Font(“宋体”, Font.PLAIN, 12));<br>        title.setForeground(Color.black);<br><br>        close.setFont(new Font(“Arial”, Font.BOLD, 15));<br>        close.setPreferredSize(new Dimension(20, 20));<br>        close.setVerticalTextPosition(JLabel.CENTER);<br>        close.setHorizontalTextPosition(JLabel.CENTER);<br>        close.setCursor(new Cursor(12));<br>        close.setToolTipText(“关闭”);<br><br>        head.setPreferredSize(new Dimension(250, 35));<br>        head.setVerticalTextPosition(JLabel.CENTER);<br>        head.setHorizontalTextPosition(JLabel.CENTER);<br>        head.setFont(new Font(“宋体”, Font.PLAIN, 12));<br>        head.setForeground(Color.blue);<br><br>        feature.setEditable(false);<br>        feature.setForeground(Color.red);<br>        feature.setFont(new Font(“宋体”, Font.PLAIN, 13));<br>        feature.setBackground(new Color(184, 230, 172));<br>        // 设置文本域自动换行<br>        feature.setLineWrap(true);<br><br>        jfeaPan.setPreferredSize(new Dimension(250, 80));<br>        jfeaPan.setBorder(null);<br>        jfeaPan.setBackground(Color.black);<br><br>        releaseLabel.setForeground(Color.DARK_GRAY);<br>        releaseLabel.setFont(new Font(“宋体”, Font.PLAIN, 12));<br><br>        // 为了隐藏文本域，加个空的JLabel将他挤到下面去<br>        JLabel jsp = new JLabel();<br>        jsp.setPreferredSize(new Dimension(300, 25));<br><br>        sure.setPreferredSize(new Dimension(110, 30));<br>        // 设置标签鼠标手形<br>        sure.setCursor(new Cursor(12));<br><br>        headPan.add(title);<br>        headPan.add(close);<br>        headPan.add(head);<br><br>        feaPan.add(jsp);<br>        feaPan.add(jfeaPan);<br>        feaPan.add(releaseLabel);<br><br>        btnPan.add(sure);<br><br>        tw.add(headPan, BorderLayout.NORTH);<br>        tw.add(feaPan, BorderLayout.CENTER);<br>        tw.add(btnPan, BorderLayout.SOUTH);<br>    }<br><br>    public void handle() {<br>        // 为更新按钮增加相应的事件<br>        sure.addMouseListener(new MouseAdapter() {<br>            public void mouseClicked(MouseEvent e) {<br>                JOptionPane.showMessageDialog(tw, “谢谢，再见”);<br>                tw.close();<br>            }<br>            public void mouseEntered(MouseEvent e) {<br>                sure.setBorder(BorderFactory.createLineBorder(Color.gray));<br>            }<br>            public void mouseExited(MouseEvent e) {<br>                sure.setBorder(null);<br>            }<br>        });<br>        // 增加鼠标拖动事件<br>        title.addMouseMotionListener(new MouseMotionAdapter() {<br>            public void mouseDragged(MouseEvent e) {<br>                // TODO Auto-generated method stub<br>                Point newP = new Point(e.getXOnScreen(), e.getYOnScreen());<br>                int x = tw.getX() + (newP.x - oldP.x);<br>                int y = tw.getY() + (newP.y - oldP.y);<br>                tw.setLocation(x, y);<br>                oldP = newP;<br>            }<br>        });<br>        // 鼠标按下时初始坐标,供拖动时计算用<br>        title.addMouseListener(new MouseAdapter() {<br>            public void mousePressed(MouseEvent e) {<br>                oldP = new Point(e.getXOnScreen(), e.getYOnScreen());<br>            }<br>        });<br>        // 右上角关闭按钮事件<br>        close.addMouseListener(new MouseAdapter() {<br>            public void mouseClicked(MouseEvent e) {<br>                tw.close();<br>            }<br>            public void mouseEntered(MouseEvent e) {<br>                close.setBorder(BorderFactory.createLineBorder(Color.gray));<br>            }<br>            public void mouseExited(MouseEvent e) {<br>                close.setBorder(null);<br>            }<br>        });<br>    }<br><br>    public void show(String titleT,String word){<br>        this.titleT = titleT;<br>        this.word = word;<br>        time = sdf.format(new Date());<br>        init();<br>        handle();<br>        tw.setAlwaysOnTop(true);<br>        tw.setUndecorated(true);<br>        tw.setResizable(false);<br>        tw.setVisible(true);<br>        tw.run();<br>    }<br>}<br><br>class TipWindow extends JDialog {<br>    private static final long serialVersionUID = 8541659783234673950L;<br>    private static Dimension dim;<br>    private int x, y;<br>    private int width, height;<br>    private static Insets screenInsets;<br><br>    public TipWindow(int width, int height) {<br>        this.width = width;<br>        this.height = height;<br>        dim = Toolkit.getDefaultToolkit().getScreenSize();<br>        screenInsets = Toolkit.getDefaultToolkit().getScreenInsets(<br>                this.getGraphicsConfiguration());<br>        x = (int) (dim.getWidth() - width - 3);<br>        y = (int) (dim.getHeight() - screenInsets.bottom - 3);<br>        initComponents();<br>    }<br><br>    public void run() {<br>        for (int i = 0; i &lt;= height; i += 10) {<br>            try {<br>                this.setLocation(x, y - i);<br>                Thread.sleep(5);<br>            } catch (InterruptedException ex) {<br>            }<br>        }<br>        // 此处代码用来实现让消息提示框5秒后自动消失<br>        try {<br>            Thread.sleep(5000);<br>        } catch (InterruptedException e) {<br>            e.printStackTrace();<br>        }<br>        close();<br>    }<br><br>    private void initComponents() {<br>        this.setSize(width, height);<br>        this.setLocation(x, y);<br>        this.setBackground(Color.black);<br>    }<br><br>    public void close() {<br>        x = this.getX();<br>        y = this.getY();<br>        int ybottom = (int) dim.getHeight() - screenInsets.bottom;<br>        for (int i = 0; i &lt;= ybottom - y; i += 10) {<br>            try {<br>                setLocation(x, y + i);<br>                Thread.sleep(5);<br>            } catch (InterruptedException ex) {<br>            }<br>        }<br>        dispose();<br>    }<br><br>    public static void main(String args[]){<br>        InfoUtil tool = new InfoUtil();<br>        tool.show(<br>                “ QQ提示消息工具类 - Develop By qsuron”,<br>                “1.博客:blog.csdn.net/qsuronn” +”2.博主:qsuronn” +”3.开发相关:Eclipse + Javan” +”4.数据库类型:无 5.1n” +”5.开发人员:小树n” +”6.联系方式:QQ 280970160”<br>                );<br>    }<br>}</pre><br></div>
          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/18/wp-syntax/" itemprop="url">
                  修改wp-syntax代码自动换行
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-18T15:17:22+08:00" content="2014-02-18">
              2014-02-18
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 425</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 2分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/网站动态/" itemprop="url" rel="index">
                    <span itemprop="name">网站动态</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/18/wp-syntax/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/18/wp-syntax/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <address> </address><br>&gt; <address>wp-syntax代码插件是个非常好用的代码高亮插件,自己博客用的就是这个。</address><address>wp-syntax在代码过长的时候默认是出现滚动条，觉得这样挺不好看的，想把它设置成过长时自动换行显示。</address><br><address> </address><address>这里记录一下自己使用的方法：编辑 wp-syntax/css/wp-syntax.css1、在.wp_syntax pre样式块中增加以下代码，兼容各浏览器<br>代码位于wp-content/plugins/wp-syntax/css/wp-syntax.css<br><br></address><br><pre class="brush:css">white-space: pre-wrap;       /<em> css-3 </em>/<br>white-space: -moz-pre-wrap;  /<em> Mozilla, since 1999 </em>/<br>white-space: -pre-wrap;      /<em> Opera 4-6 </em>/<br>white-space: -o-pre-wrap;    /<em> Opera 7 </em>/<br>word-wrap: break-word;       /<em> Internet Explorer 5.5+ </em>/</pre><br><address>2、修改.wp_syntax<br>代码位于wp-content/plugins/wp-syntax/css/wp-syntax.css<br><br></address><br><pre class="brush:css">.wp_syntax {<br>    color           : #100;<br>    background-color: #f9f9f9;<br>    border          : 1px solid silver;<br>    margin          : 0 0 1.5em 0;<br>    width:95%;<br>    overflow        : hidden;<br>}</pre><br><address>大功告成。<br><br>测试：<br><br></address><br><pre class="brush:java">//程序员必看的十大电影         不同的行业领域中很多时候都分享着共同的思想和理念。比如，大量的计算机编程中涉及到的概念都被运用到了电影里。有些概念出现在电影里后变得如此之 酷，甚至反过来能帮助我们程序员更好的理解这些概念。</pre><br><pre class="brush:java">public static void main(String[] agrs){</pre><br><pre class="brush:java">    System.out.println(“ew”);</pre><br><pre class="brush:java">}</pre><br><pre class="brush:java">//下面就是我最喜欢的10大电影，它们都在某方便帮助了我理解编程中的某些</pre><br><address> </address>
          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/18/wordpress-paging/" itemprop="url">
                  不用插件完美实现WordPress长文章分页
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-18T14:51:06+08:00" content="2014-02-18">
              2014-02-18
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 570</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 3分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/网站动态/" itemprop="url" rel="index">
                    <span itemprop="name">网站动态</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/18/wordpress-paging/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/18/wordpress-paging/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="不用插件完美实现WordPress长文章分页"><a href="#不用插件完美实现WordPress长文章分页" class="headerlink" title=" 不用插件完美实现WordPress长文章分页"></a><span style="font-size: x-large;"> 不用插件完美实现WordPress长文章分页</span></h1><p>&nbsp;</p>
<p>Wordpress博客本身是有文章分页这个功能的，只不过默认给隐藏了。我们需要将这个功能激活，才能使用默认的文章分页功能。</p>
<blockquote>
<p>标签 &lt;!-–nextpage-–&gt; 来对文章内容进行<strong>分页</strong>的<br>如果你在文章中已经添加了&lt;!–nextpage–&gt;却没有显示出分页来，那么你就需要在相关的模板文件中加入一个函数。</p>
</blockquote>
<p>在主题中找到文件 <strong>single.php</strong> ,找到类似下面的代码：</p>
<p><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/TM截图20140218144337.jpg" alt="" title="TM截图20140218144337"></p>
<p>&nbsp;</p>
<p>然后在后面加上:</p>
<p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/TM截图20140218144330.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/TM截图20140218144330.jpg" alt="" title="TM截图20140218144330"></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>这样就可以显示默认的分页效果了。</p>
<p>如果对默认的不满意，可以使用下面：</p>
<pre class="brush:java">
<?php wp_link_pages('link_before=<span>&link_after=&before=<div id="single-navi"><div>

<span>页面:</span>&after=&next_or_number=number'); ?>
<?php wp_link_pages('before=&after=
<div></div></div>&next_or_number=next&previouspagelink=上一页&nextpagelink=下一页'); ?>
</pre>

<p>如果你觉得还不够美观，可以自己修改CSS，下面是本博客使用的代码跟CSS。如果你喜欢，可以直接拿去使用。</p>
<pre class="brush:java">
<div><?php wp_link_pages(array('before' => '<div class="fenye">分页阅读：', 'after' => '', 'next_or_number' => 'next', 'previouspagelink' => '上一页', 'nextpagelink' => "")); ?>   <?php wp_link_pages(array('before' => '', 'after' => '', 'next_or_number' => 'number', 'link_before' =>'<span>', 'link_after'=>'</span>')); ?>   <?php wp_link_pages(array('before' => '', 'after' => '</div>', 'next_or_number' => 'next', 'previouspagelink' => '', 'nextpagelink' => "下一页")); ?></div>
</pre>

<p>&nbsp;</p>
<pre class="brush:java">
/**页面分页**/
.fenye{text-align:center;margin:0px auto 10px;font-weight:bold}
.fenye span{background-color:#DDDDDD;color:#fff;font-weight: bold;margin:0px 1px;padding:1px 6px;display:inline-block;text-decoration:none;border:1px solid #e0e0e0;}
.fenye a{text-decoration:none;}
.fenye a span{background-color:#F6F6E8;font-weight: normal;color: #000;text-decoration: none;}
.fenye a:hover span{background-color:#DDDDDD;color: #fff;}
</pre>

<p>效果如下：</p>
<p>分页内容被标签截断了abcd<br><!--nextpage--><br>efghi</p>
<p>jklnm</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/17/about-me/" itemprop="url">
                  关于
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-17T23:41:11+08:00" content="2014-02-17">
              2014-02-17
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 567</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 2分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/网站动态/" itemprop="url" rel="index">
                    <span itemprop="name">网站动态</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/17/about-me/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/17/about-me/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/TM截图20140221132050.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/TM截图20140221132050.jpg" alt="" title="TM截图20140221132050"></a></p>
<ul>
<li><h1 id="关于博客"><a href="#关于博客" class="headerlink" title="关于博客"></a>关于博客</h1>我本为追回自身的青春活力而出游，而一落笔却比过去写的任何文章都显得苍老。</li>
</ul>
<p>我写博客，不为何，只为了心中那一丝丝萌动。</p>
<p>&nbsp;</p>
<ul>
<li><h1 id="关于博主"><a href="#关于博主" class="headerlink" title="关于博主"></a>关于博主</h1><a href="http://www.qiushurong.cn/wp-content/uploads/2014/02/10寸稠面-PVC照片-副a本.jpg" target="_blank" rel="external"><img src="http://www.qiushurong.cn/wp-content/uploads/2014/02/10寸稠面-PVC照片-副a本.jpg" alt="" title="13年夏天游玩的照片，是不是有一种帅气阳光的感觉，至我最喜欢的昆明湖."></a></li>
</ul>
<p>本名邱树荣、江湖人称小树、互联网人称qsuron；</p>
<p>个人简历：<a href="http://resume.qiushurong.cn" title="小树的简历" target="_blank" rel="external">链接</a></p>
<p>就读于 春如四季 的 广州番禺职业技术学院 - 信息工程学院；</p>
<p>我从事IT技术研发运营工作，就是每天撰写英文那种，心情好的时候也会加点中文翻译，说白了就是“程序猿”；</p>
<p>单身男、爱好女：同性可选择仰慕、崇拜或暗恋，但请不要做出无谓的牺牲，我的立场很坚定；</p>
<p>为何写博客：代码敲的累了，换个中文悠闲悠闲，但请不要以为我是闲的蛋疼；</p>
<p>我是好人，但好人也是人！</p>
<ul>
<li><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1>四面围墙，掌触键鼠，正对荧屏，左脑繁忙，口咽咖啡。</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><h1 id="联系方式"><a href="#联系方式" class="headerlink" title="联系方式"></a>联系方式</h1>个人邮箱 admin@qiushurong.cn <a href="mailto:admin@qiushurong.cn" target="_blank" rel="external"><img src="http://rescdn.qqmail.com/zh_CN/htmledition/images/function/qm_open/ico_mailme_11.png" alt=""></a></li>
</ul>
<p>或在博客评论，看到必回。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>邱树荣/小树/qsuron     </strong></p>
<p><strong>2014年2月17日 于 青山湖畔</strong></p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/02/17/jsp-mysql-code/" itemprop="url">
                  jsp乱码问题-java与mysql的字符集统一
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-17T22:33:38+08:00" content="2014-02-17">
              2014-02-17
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 1,408</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 7分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-EE/" itemprop="url" rel="index">
                    <span itemprop="name">Java EE</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-EE/通用开发技术/" itemprop="url" rel="index">
                    <span itemprop="name">通用开发技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/17/jsp-mysql-code/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/17/jsp-mysql-code/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;</p>
<h1 id="jsp乱码问题-java与mysql的字符集统一"><a href="#jsp乱码问题-java与mysql的字符集统一" class="headerlink" title="jsp乱码问题-java与mysql的字符集统一"></a>jsp乱码问题-java与mysql的字符集统一</h1><p>&nbsp;</p>
<p>&nbsp;</p>
<div style="font-size: 14px; line-height: 26px; word-wrap: break-word; color: #666666; font-family: 宋体, Arial;"><br><br>1、在jsp中，字符集由&lt;%@ page language=”java” contentType=”text/html;charset=GBK”%&gt;来指定，如果处理中文，需指定为gbk。所以提交的数据全部都使用gbk编码；<br><br>2、在java中，从jsp提交过来的数据是gbk编码的，而java默认的处理方式是使用ISO-8859-1编码，所以若在java中能显示jsp提交过来的gbk编码方式的数据，就要进行一个转换：将gbk转换为ISO-8859-1，这样数据就可正常显示。<br><br>3、如果要将jsp提交的数据经过java后台处理，然后放入数据库中，就又多了一个数据编码方式：数据库的数据编码方式。以mysql为例，默认字符集为latin，所以若将gbk的数据放入，必然出现乱码，所以首先应改变数据库的编码方式为gbk。<br><br></div><br><div style="font-size: 14px; line-height: 26px; word-wrap: break-word; color: #666666; font-family: 宋体, Arial;">综上，简单的设置方法如下：</div><br><div style="font-size: 14px; line-height: 26px; word-wrap: break-word; color: #666666; font-family: 宋体, Arial;"><br><br>jsp(gbk) —-&gt;java(ISO-8859-1) —&gt; mysql(gbk)<br><br>还有一种情况会出现乱码：当你在jsp端提交一个id号，然后在java处理端通过id号得到数据库中的gbk（汉字）数据，这是就会出现乱码，因为java处理的是ISO-8859-1，你在java到mysql中有了一个ISO-8859-1到gbk的转换，而这些数据本身就是ISO-8859-1,所以转换后就出现问题了。<br><br>解决办法：将在java中处理的gbk数据转换为ISO-8859-1即可。<br><br></div><br><div style="font-size: 14px; line-height: 26px; word-wrap: break-word; color: #666666; font-family: 宋体, Arial;">总之：在jsp，java，mysql三者之间的编码方式必须统一，不能错误的转换或者不转换。</div><br><div style="font-size: 14px; line-height: 26px; word-wrap: break-word; color: #666666; font-family: 宋体, Arial;">一些相关转换函数：</div><br><div style="font-size: 14px; line-height: 26px; word-wrap: break-word; color: #666666; font-family: 宋体, Arial;"><span style="color: #009900; word-wrap: break-word;">1、String 到 Unicode</span></div><br><div><br><pre class="brush:java">public static String toUTF(String inPara){<br>//将字符串转换成Unicode编码<br>char temChr;<br>int ascChr;<br>int i;<br>String rtStr=new String(“”);<br>if(inPara==null){<br>inPara=””;<br>}<br>for(i=0;i&lt;inPara.length();i++){<br>temChr=inPara.charAt(i);<br>ascChr=temChr+0;<br>String z=””;<br>String hex=Integer.toHexString(ascChr);<br>//   ————如果不够四位则高位补零——————<br>for(int j=0;j&lt;4-hex.length();j++)<br>{<br>z+=”0”;<br>}<br>//System.out.println(ascChr);<br>//System.out.println(Integer.toBinaryString(ascChr));<br>rtStr=rtStr+”&amp;#x”+z+hex+”;”;<br>}<br>return rtStr;<br>}</pre><br><span style="color: #009900; word-wrap: break-word;">2、String 到 ISO-8859-1</span><br><br></div><br><pre class="brush:java">public static String to8859(String s){<br>String str=s;<br>try{<br>byte b[]=str.getBytes(“ISO-8859-1”);<br>str=new String(b);<br>return str;<br>}<br>catch(Exception e){return null;}<br>}</pre><br><div style="font-size: 14px; line-height: 26px; word-wrap: break-word; color: #666666; font-family: 宋体, Arial;"></div><br><div style="font-size: 14px; line-height: 26px; word-wrap: break-word; color: #666666; font-family: 宋体, Arial;"><span style="color: #009900; word-wrap: break-word;">3、gbk 到 latin1</span></div><br><pre class="brush:java">public  static  String  tolatin1(String  strChinese)<br>{<br>try<br>{<br>return  new String(strChinese.getBytes(“gbk”),”latin1”);<br>}catch(  Exception  e)<br>{<br>return  “”;<br>}<br>}</pre><br>解决方法一:(最重要的一种方法)<br>你看下my.ini，有无<br><pre class="brush:java">[mysql]<br><br>default-character-set=utf8<br><br>[client]<br>default-character-set=utf8<br><br>[mysqld]<br>default-character-set=utf8</pre><br>然后建立表时，也要用（比如）<br><pre class="brush:java">DROP   TABLE   IF   EXISTS   <code>Company</code>;<br>CREATE   TABLE   IF   NOT   EXISTS   <code>Company</code><br>(<br><code>Cname</code>   VARCHAR(10)   NOT   NULL,<br><code>Caddr</code>   VARCHAR(100),<br><code>Ctel</code>     VARCHAR(16)<br>)ENGINE=InnoDB   DEFAULT   CHARSET=UTF8;</pre><br>这样就没问题。<br><br>如果是jsp要声明：<br><pre class="brush:java">contentType=”text/html;charset=gb2312”</pre><br>解决方法二：<br><br>连接mysql时(无论在从mysql读还是取数据的情况)，指定使用的编码方式为utf-8，具体代码如下<br><pre class="brush:java">//装载mysql-jdbc驱动<br><br>Class.forName(“com.mysql.jdbc.Driver”).newInstance();<br><br>//连接数据库<br><br>Connection sqlCon = DriverManager.getConnection( “jdbc:mysql://localhost:3306/test?                         user=root&amp;password=1&amp;useUnicode=true&amp;characterEncoding=utf-8” );</pre><br>解决方法三：<br><br>如果方法一不行那么在方法一的基础上对读入的字符串进行强制编码方式转换。<br><br>代码示例如下：<br><pre class="brush:java">String name = rst.getString(“name”);<br>name= new String(name.getBytes(“ISO-8859-1”),”utf-8”);</pre><br>注：代码也可以为：<br><pre class="brush:java">String name =new String( rst.getString(“name”).getBytes(“ISO-8859-1”),”utf-8”));</pre><br>其中rst为返回的resultset,ISO-8859-1为mysql默认的编码方式，代码的目的是把以ISO-8859-1的编码转换为gb2312编码方式，这样强制转换，可以解决一部分问题，如果结合方法一，应该可以解决中文乱码问题。<br><br>解决方法四：<br><br>这个方法在有些文章里是首推的，我首先也是试了这个方法，但是好像不行。这里还是说一下，不知是不是我操作错误。还是先贴原文吧：<br><br>“如果数据库中有中文的话而mysql默认的语言不是中文时要在配置文件C:winntmy.ini 中的 [mysqld] 里添加一行：<br><pre class="brush:java">default-character-set=utf-8</pre><br>然后重起mysql<br><div><br><br>可以在你的loginservlet.java中加入<br><pre class="brush:java">request.setCharacterEncoding(“gb2312”);</pre><br>或者：<br><pre class="brush:java">String sUserName = new String(request.getParameter(“txtUserName”).getBytes(“ISO-8859-1”),”gb2312”);</pre><br></div>
          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/head.jpg"
               alt="邱树荣" />
          <p class="site-author-name" itemprop="name">邱树荣</p>
          <p class="site-description motion-element" itemprop="description">致力于计算机程式开发</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">110</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">195</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="powered-by" >
  
  <span itemprop="copyrightYear">&copy;2016 - 2026</span>

  <a style="" class="theme-link" href="https://qiushurong.github.io">
    小树技术博客
  </a>

</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  粤ICP备<a class="theme-link" href="https://qiushurong.github.io">
    15021480
  </a>号
</div>

        

        
      </div>
    </footer>

    <!--qsuron20160418 返回顶部更换为火箭
    div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div-->

    <a id="rocket" href="#top" class=""></a>


  </div>


  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"qsuron"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
      
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  





  
  
  

  

  

</body>
</html>
