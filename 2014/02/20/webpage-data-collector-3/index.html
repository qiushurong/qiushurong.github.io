<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.useso.com/css?family=Monda:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  




<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="网页,采集," />








  <link rel="shortcut icon" type="image/x-icon" href="/images/head.ico?v=5.0.1" />






<meta name="description" content="本期概述上一期我们学习了如何将html采集到的数据存储到MySql数据库中,这期我们来学习下如何在存储的数据中查询我们实际想看到的数据.

数据采集页面 2011-2012赛季英超球队战绩
&amp;nbsp;

如果是初学者 以下可能对你有帮助

Java如何操作MySql?在使用java 操作MySql数据库之前 我们需要在项目文件中导入 一个jar包(mysql-connector-java-5.">
<meta property="og:type" content="article">
<meta property="og:title" content="Java网页数据采集器[下篇-数据查询]">
<meta property="og:url" content="http://yoursite.com/2014/02/20/webpage-data-collector-3/index.html">
<meta property="og:site_name" content="小树技术博客">
<meta property="og:description" content="本期概述上一期我们学习了如何将html采集到的数据存储到MySql数据库中,这期我们来学习下如何在存储的数据中查询我们实际想看到的数据.

数据采集页面 2011-2012赛季英超球队战绩
&amp;nbsp;

如果是初学者 以下可能对你有帮助

Java如何操作MySql?在使用java 操作MySql数据库之前 我们需要在项目文件中导入 一个jar包(mysql-connector-java-5.">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200452123.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200453485.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200455139.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200460164.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200473030.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200482549.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200491649.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200493329.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200494918.png">
<meta property="og:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200504236.png">
<meta property="og:updated_time" content="2016-04-28T14:05:28.750Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java网页数据采集器[下篇-数据查询]">
<meta name="twitter:description" content="本期概述上一期我们学习了如何将html采集到的数据存储到MySql数据库中,这期我们来学习下如何在存储的数据中查询我们实际想看到的数据.

数据采集页面 2011-2012赛季英超球队战绩
&amp;nbsp;

如果是初学者 以下可能对你有帮助

Java如何操作MySql?在使用java 操作MySql数据库之前 我们需要在项目文件中导入 一个jar包(mysql-connector-java-5.">
<meta name="twitter:image" content="http://pic002.cnblogs.com/images/2012/326877/2012021200452123.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 5322878,
      author: '小树'
    }
  };
</script>

  <title> Java网页数据采集器[下篇-数据查询] | 小树技术博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  

  <div class="container one-collumn  page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">小树技术博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">用文字留住时间、用博客记录生命</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Java网页数据采集器[下篇-数据查询]
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-02-20T19:42:27+08:00" content="2014-02-20">
              2014-02-20
            </time>
          </span>

<span class="post-count">&nbsp; | &nbsp;字数 4,255</span>
<span class="post-count">&nbsp; | &nbsp;预计阅读 21分钟</span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java-SE/" itemprop="url" rel="index">
                    <span itemprop="name">Java SE</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/02/20/webpage-data-collector-3/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/20/webpage-data-collector-3/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>本期概述<br>上一期我们学习了如何将html采集到的数据存储到MySql数据库中,这期我们来学习下如何在存储的数据中查询我们实际想看到的数据.</p>
</blockquote>
<p>数据采集页面 <a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">2011-2012赛季英超球队战绩</a></p>
<p>&nbsp;</p>
<blockquote>
<p>如果是初学者 以下可能对你有帮助</p>
<ul>
<li>Java如何操作MySql?<br>在使用java 操作MySql数据库之前 我们需要在项目文件中导入 一个jar包(mysql-connector-java-5.1.18-bin)</li>
</ul>
</blockquote>
<p>可以在MySql官网下载 <a href="http://www.mysql.com/downloads/connector/j/" target="_blank" rel="external">Connector/J 5.1.18</a></p>
<p>第一次使用MySql?   请看 <a href="http://www.cnblogs.com/longwu/articles/2310577.html" target="_blank" rel="external">java连接MYSQL </a></p>
<blockquote>
<ul>
<li>如何在java项目中导入jar包?<br>请看这个 <a href="http://blog.csdn.net/justinavril/article/details/2783182" target="_blank" rel="external">Eclipse下如何导入jar包</a></li>
<li>如何安装MySql数据库?<br>如果是初学者 想使用MySql数据库的话 可以去这里 <a href="http://www.apachefriends.org/zh_cn/xampp.html" target="_blank" rel="external">XAMPP中文官网</a>  下载 XAMPP 套装</li>
</ul>
</blockquote>
<p>XAMPP（Apache+MySQL+PHP+PERL）是一个功能强大的建 XAMPP 软件站集成软件包, 而且一键式安装, 无需修改配置文件,非常好用.</p>
<p>&nbsp;</p>
<p>关于,如何在MySql里创建数据库,请看<a href="http://www.cnblogs.com/longwu/archive/2012/01/03/2310588.html" title="Java网页数据采集器实例教程[中篇-数据存储]" target="_blank" rel="external">Java网页数据采集器实例教程[中篇-数据存储]</a>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>数据库准备好了,我们开始写java程序代码;</p>
<p>这期,我们主要在MySql 类里增加了一个数据查看的方法 queryMySql(),并增加了一个 DataQuery类, 包含了一些比赛结果的查询方法.</p>
<p>&nbsp;</p>
<p>主程序代码</p>
<p>这里简单介绍下各个类以及包含的方法</p>
<p>DataCollectionAndStorage类 和里面的dataCollectAndStore() 方法 用于Html数据采集和存储</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><pre class="brush:java"><br>import java.io.BufferedReader;<br>import java.io.IOException;<br>import java.io.InputStreamReader;<br>import java.net.URL;<br>/**</pre></p>
<ul>
<li>DataCollectionAndStorage类 用于数据的收集和存储</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br><em>/<br>public class DataCollectionAndStorage {<br>/*</em></p>
<ul>
<li><p>dataCollectAndStore()方法  用于Html数据收集和存储<br>*/<br>public void dataCollectAndStore() {<br>  // 首先用一个字符串 来装载网页链接<br>  String strUrl = “<a href="http://www.footballresults.org/league.php?all=1&amp;league=EngPrem" target="_blank" rel="external">http://www.footballresults.org/league.php?all=1&amp;league=EngPrem</a>“;</p>
<p>  String sqlLeagues = “”;<br>  try {</p>
<pre><code>// 创建一个url对象来指向 该网站链接 括号里()装载的是该网站链接的路径
// 更多可以看看 http://wenku.baidu.com/view/8186caf4f61fb7360b4c6547.html
URL url = new URL(strUrl);
// InputStreamReader 是一个输入流读取器 用于将读取的字节转换成字符
// 更多可以看看 http://blog.sina.com.cn/s/blog_44a05959010004il.html
InputStreamReader isr = new InputStreamReader(url.openStream(),
        &quot;utf-8&quot;); // 统一使用utf-8 编码模式
// 使用 BufferedReader 来读取 InputStreamReader 转换成的字符
BufferedReader br = new BufferedReader(isr);
String strRead = &quot;&quot;; // new 一个字符串来装载 BufferedReader 读取到的内容

// 定义3个正则 用于获取我们需要的数据
String regularDate = &quot;(\d{1,2}\.\d{1,2}\.\d{4})&quot;;
String regularTwoTeam = &quot;&gt;[^&lt;&gt;]*&lt;/a&gt;&quot;;
String regularResult = &quot;&gt;(\d{1,2}-\d{1,2})&lt;/TD&gt;&quot;;

//创建 GroupMethod类的对象 gMethod 方便后期调用其类里的 regularGroup方法
GroupMethod gMethod = new GroupMethod();
//创建DataStructure数据结构 类的对象   用于数据下面的数据存储
DataStructure ds = new DataStructure();
//创建MySql类的对象 用于执行MySql语句
MySql ms = new MySql();
int i = 0; // 定义一个i来记录循环次数 即收集到的球队比赛结果数
int index = 0; // 定义一个索引 用于获取分离 2个球队的数据 因为2个球队正则是相同的
// 开始读取数据 如果读到的数据不为空 则往里面读
while ((strRead = br.readLine()) != null) {
    /**
     * 用于捕获日期数据
     */
    String strGet = gMethod.regularGroup(regularDate, strRead);
    // 如果捕获到了符合条件的 日期数据 则打印出来

    if (!strGet.equals(&quot;&quot;)) {
        //System.out.println(&quot;Date:&quot; + strGet);
        //将收集到的日期存在数据结构里
        ds.date = strGet;
        // 这里索引+1 是用于获取后期的球队数据
        ++index; // 因为在html页面里 源代码里 球队数据是在刚好在日期之后
    }
    /**
     * 用于获取2个球队的数据
     */
    strGet = gMethod.regularGroup(regularTwoTeam, strRead);
    if (!strGet.equals(&quot;&quot;) &amp;&amp; index == 1) { // 索引为1的是主队数据
        // 通过subtring方法 分离出 主队数据
        strGet = strGet.substring(1, strGet.indexOf(&quot;&lt;/a&gt;&quot;));
        //System.out.println(&quot;HomeTeam:&quot; + strGet); // 打印出主队
        //将收集到的主队名称 存到 数据结构里
        ds.homeTeam = strGet;
        index++; // 索引+1之后 为2了
        // 通过subtring方法 分离出 客队
    } else if (!strGet.equals(&quot;&quot;) &amp;&amp; index == 2) { // 这里索引为2的是客队数据
        strGet = strGet.substring(1, strGet.indexOf(&quot;&lt;/a&gt;&quot;));
        //System.out.println(&quot;AwayTeam:&quot; + strGet); // 打印出客队
        //将收集到的客队名称 存到数据结构里
        ds.awayTeam = strGet;
        index = 0;  //收集完客队名称后 需要将索引还原 用于收集下一条数据的主队名称
    }
    /**
     * 用于获取比赛结果
     */
    strGet = gMethod.regularGroup(regularResult, strRead);
    if (!strGet.equals(&quot;&quot;)) {
        // 这里同样用到了substring方法 来剔除&apos;&lt;&apos; 和 &quot;&lt;/TD&gt;&quot; 标签 来获取我们想要的比赛结果
        strGet = strGet.substring(1, strGet.indexOf(&quot;&lt;/TD&gt;&quot;));
        //System.out.println(&quot;Result:&quot; + strGet);
        ds.result = strGet; //将收集到的比赛结果存到数据结构里
        //System.out.println();

        //MySql插入语句
        sqlLeagues = &quot;INSERT INTO Premiership values(&quot;&quot;
                + ds.date + &quot;&quot;,&quot; + &quot;&quot;&quot; + ds.homeTeam
                + &quot;&quot;,&quot; + &quot;&quot;&quot; + ds.awayTeam + &quot;&quot;,&quot;+ &quot;&quot;&quot; + ds.result + &quot;&quot;)&quot;;
        //调用MySql类的datatoMySql()方法 来执行 MySql插入语句
        ms.datatoMySql(sqlLeagues);
        i++; //每插入完一条记录 i+1;
        System.out.println(&quot;第&quot;+i+&quot;条数据插入成功&quot;);
    }
}
// 当读完数据后 记得关闭 BufferReader
br.close();
//System.out.println(&quot;共收集到&quot; + i + &quot;条比赛记录&quot;);// 打印出循环次数
//当数据存储完成后 打印出 收集球队记录数
System.out.println(&quot;数据存储完毕,共插入数据库&quot;+i+&quot;条记录&quot;);
</code></pre><p>  } catch (IOException e) {</p>
<pre><code>// 如果出错 抛出异常
e.printStackTrace();
</code></pre><p>  }<br>}<br>}<br><br>&nbsp;</p>
</li>
</ul>
</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>DataQuery类 里面有4个方法</p>
<ol>
<li>initialDataBase() 用于清空数据库里的所有比赛数据</li>
<li>getAllTeams()    用于获取当前数据库里所有球队的名字</li>
<li>querySpecifiedTeam()   用于查询具体球队的比赛情况 (可以查看你喜欢的球队比赛结果)</li>
<li><p>queryByDate()  用于查询具体日期的比赛 (查询某一天的比赛结果)</p>
<div></div><br><div></div><br><pre class="brush:java"><br>import java.sql.ResultSet;<br>import java.sql.SQLException;<br>import java.util.ArrayList;<br>import java.util.List;<br>import java.util.Vector;<br>/<strong><br><em> DataQuery 类  用于查询数据库里的信息 包含了不同的方法
</em> @author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class DataQuery {<br>/</strong><br> <em> 用于清空数据库里比赛结果
 </em>/<br>public void initialDataBase() {<br>    String initialSql = “delete from premiership”;<br>    MySql ms = new MySql();<br>    try {<br>        //MySql类里 提供了一个 删除数据的 方法 executeUpdate()<br>        ms.datatoMySql(initialSql);<br>        System.out.println(“数据库清空成功!”);<br>    } catch (Exception e) {<br>        System.out.println(“数据库清空失败!”);<br>    }<br>}<br><br>/<strong><br> <em> 用于 获取当前数据库里一共有多少球队 方便后期查看自己喜欢的球队比赛成绩
 </em> @return 所有的参与过比赛的球队名<br> */<br>public Vector<string> getAllTeams() {<br>    //使用一个向量来 存取 从数据库中读到的值<br>    Vector<string> vecAllTeams = new Vector<string>();<br>    String allteamsSql = “select HomeTeam,AwayTeam from premiership group by HomeTeam;”;<br>    ResultSet rs = null;<br>    MySql ms = new MySql();<br>    //调用 MySql类里 查看数据的方法<br>    rs = ms.queryMySql(allteamsSql);<br>    try {<br>        //如果 ResultSet数据集里的数据不为空  则获取相应的 数据 添加到 向量vecAllTeams里<br>        while (rs.next()) {<br>            if (!vecAllTeams.contains(rs.getString(“HomeTeam”)))<br>                vecAllTeams.add(rs.getString(“HomeTeam”));<br>            else if (!vecAllTeams.contains(rs.getString(“AwayTeam”)))<br>                vecAllTeams.add(rs.getString(“AwayTeam”));<br>        }<br><br>    } catch (SQLException e) {<br>        System.out.println(e.getMessage());<br>        e.printStackTrace();<br>    }<br>    //返回 取到的所有结果<br>    return vecAllTeams;<br><br>}<br><br>/</string></string></string></strong><br> <em> 查看具体的球队比赛结果
 </em> @param league<br> <em> @return 具体球队的所有比赛结果
 </em>/<br>public Vector<string> querySpecifiedTeam(String league) {<br>    //创建一个向量 来装载 从数据库中 读到的数据<br>    Vector<string> lsMatches = new Vector<string>();<br>    String specifiedTeamSql = “select <em> from premiership where HomeTeam =’”<br>            + league + “‘ or AwayTeam =’” + league + “‘“;<br>    MySql ms = new MySql();<br>    ResultSet rs = null;<br>    rs = ms.queryMySql(specifiedTeamSql);<br>    try {<br>        while (rs.next()) {<br>            lsMatches.add(rs.getString(“Date”));<br>            lsMatches.add(rs.getString(“HomeTeam”));<br>            lsMatches.add(rs.getString(“AwayTeam”));<br>            lsMatches.add(rs.getString(“Result”));<br>        }<br>    } catch (SQLException e) {<br>        e.printStackTrace();<br>    }<br>    return lsMatches;<br><br>}<br>/**
</em> 查看 某一天的 比赛结果<br><em> @param date
</em> @return 某一天的所有比赛结果<br><em>/<br>public List<string> queryByDate(String date) {<br>    //使用一个 list泛型来装载 比赛结果<br>    List<string> lsMatchesOnDate = new ArrayList<string>();<br>    String sqlDate = “SELECT </string></string></string></em> FROM premiership WHERE Date =’” + date + “‘“;<br>    //创建一个ResultSet数据集  用来 获取查询到的结果集<br>    ResultSet rs = null;<br>    MySql ms = new MySql();<br>    //调用 MySql 类里的 查看数据库数据的方法<br>    rs = ms.queryMySql(sqlDate);<br>    try {<br>        //如果 ResultSet数据集 不为空<br>        while (rs.next()) {<br>            //则 从ResultSet数据集 中取出 相应的 字段值 添加到 list泛型里<br>            lsMatchesOnDate.add(rs.getString(“Date”));<br>            lsMatchesOnDate.add(rs.getString(“HomeTeam”));<br>            lsMatchesOnDate.add(rs.getString(“AwayTeam”));<br>            lsMatchesOnDate.add(rs.getString(“Result”));<br>        }<br>    } catch (SQLException e) {<br>        System.out.println(e.getMessage());<br>        e.printStackTrace();<br>    }<br>    //最后 返回 取到的所有比赛数据结果<br>    return lsMatchesOnDate;<br>}<br>}<br></string></string></string></pre><br><div></div><br><div></div>

</li>
</ol>
<!--nextpage-->
<p><div></div></p>
<p><div>DataStructure类 一个简单的数据结构 用于收集到数据的临时性存储</div></p>
<p><div></div></p>
<p><div></div></p>
<p><pre class="brush:java"><br>/**</pre></p>
<ul>
<li>DataStructure 类 一个简单的数据结构</li>
<li>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br><em>/<br>public class DataStructure {<br> //定义数据字段<br> public String homeTeam;<br> public String awayTeam;<br> public String date;<br> public String result;<br>}<br><br><div></div><br><div></div><br><div></div><br><div></div><br><div>GroupMethod类 里面包含了regularGroup() 方法 用于匹配并获取 html的数据</div><br><div></div><br><div></div><br><pre class="brush:java"><br>import java.util.regex.Matcher;<br>import java.util.regex.Pattern;<br>/*</pre></em></li>
<li>GroupMethod 类 用于匹配和抓取 html页面的数据</li>
<li>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class GroupMethod {<br> // 传入2个字符串参数 一个是pattern(我们使用的正则) 另一个matcher是html源代码<br> public String regularGroup(String pattern, String matcher) {<pre><code>Pattern p = Pattern.compile(pattern, Pattern.CASE_INSENSITIVE);
Matcher m = p.matcher(matcher);
if (m.find()) { // 如果读到
    return m.group();// 返回捕获的数据
} else {
    return &quot;&quot;; // 否则返回一个空字符串
}
</code></pre> }<br>}<br><br><div></div><br><div></div><br><div></div><br><div></div><div>

</div></li>
</ul>
<p>MySql类 里面含有2个方法</p>
<ul>
<li>datatoMySql() 方法 用于向数据库里插入数据</li>
<li>queryMySql() 方法 用于查看数据库里存储的数据<br><br><div></div><br><div></div><br><pre class="brush:java"><br>import java.sql.Connection;<br>import java.sql.DriverManager;<br>import java.sql.ResultSet;<br>import java.sql.SQLException;<br>import java.sql.Statement;</pre></li>
</ul>
<p>/**</p>
<ul>
<li>MySql类用于实施MySql数据库操作</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class MySql {</p>
<p> // 定义MySql驱动,数据库地址,数据库用户名 密码, 执行语句和数据库连接<br> public String driver = “com.mysql.jdbc.Driver”;<br> public String url = “jdbc:mysql://127.0.0.1:3306/htmldatacollection”;<br> public String user = “root”;<br> public String password = “root”;<br> public Statement stmt = null;<br> public Connection conn = null;</p>
<p> /**</p>
<ul>
<li>创建一个插入数据的方法  executeUpdate()</li>
<li><p>@param insertSQl<br>*/<br>public void datatoMySql(String insertSQl) {</p>
<p> try {</p>
<pre><code>try {
    Class.forName(driver).newInstance();
} catch (Exception e) {
    System.out.println(&quot;无法找到驱动器&quot;);
    e.printStackTrace();
}
// 创建连接
conn = DriverManager.getConnection(url, user, password);
// 创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
// 执行SQL 插入语句
stmt.executeUpdate(insertSQl);
// 执行完 停止执行语句
stmt.close();
// 执行完关闭数据库连接
conn.close();
</code></pre><p> } catch (Exception e) {</p>
<pre><code>System.out.println(e.getMessage());
e.printStackTrace();
</code></pre><p> }<br>}</p>
<p>/**</p>
</li>
<li>创建一个用于select查看数据的方法 executeQuery();</li>
<li>@param strSelect</li>
<li><p>@return ResultSet<br>*/<br>public ResultSet queryMySql(String strSelect) {<br> // 创建一个数据集 用于获取查询到的行数据<br> ResultSet rs = null;<br> try {</p>
<pre><code>Class.forName(driver).newInstance();
</code></pre><p> } catch (Exception e) {</p>
<pre><code>System.out.println(&quot;无法找到驱动器!&quot;);
e.printStackTrace();
</code></pre><p> }</p>
<p> try {</p>
<pre><code>// 创建连接
conn = DriverManager.getConnection(url, user, password);
// 创建一个 Statement 对象来将 SQL 语句发送到数据库
stmt = conn.createStatement();
// 执行查询语句   获取ResultSet对象
rs = stmt.executeQuery(strSelect);
</code></pre><p> } catch (SQLException e) {</p>
<pre><code>System.out.println(e.getMessage());
e.printStackTrace();
</code></pre><p> }<br> //返回结果集<br> return rs;<br>}<br>}<br><br><div></div><br><div></div><br><div>Main 主函数 用于数据输出</div><br><div></div><br><pre class="brush:java"><br>import java.util.List;<br>import java.util.Scanner;<br>import java.util.Vector;<br>/**</pre></p>
</li>
</ul>
</li>
<li>Main 主函数 用于数据的输出</li>
<li><p>@author SoFlash - 博客园  <a href="http://www.cnblogs.com/longwu" target="_blank" rel="external">http://www.cnblogs.com/longwu</a><br>*/<br>public class Main {<br> public static void main(String[] args) {</p>
<pre><code>DataCollectionAndStorage dcs = new DataCollectionAndStorage();
DataQuery dQuery = new DataQuery();

while (true) {
    System.out.println(&quot;清空数据库-请按1&quot;);
    System.out.println(&quot;收集英超比赛数据-请按2&quot;);
    System.out.println(&quot;查看英超所有球队-请按3&quot;);
    System.out.println(&quot;查看具体球队比赛结果-请按4&quot;);
    System.out.println(&quot;查看某一天的比赛-请按5&quot;);
    // Scanner 文本扫描器 用于读取 用户的输入 
    Scanner sc = new Scanner(System.in);
    int intInput = sc.nextInt();
    if (intInput == 1) {
        dQuery.initialDataBase();
        System.out
                .println(&quot;---------------------------------------------&quot;);
    } else if (intInput == 2) {
        dcs.dataCollectAndStore();
        System.out
                .println(&quot;---------------------------------------------&quot;);
    } else if (intInput == 3) {
        //获取 查询到的所有球队名称
        Vector&lt;String&gt; vecAllTeams = dQuery.getAllTeams();
        if (vecAllTeams.size() != 0) {
            System.out.println(&quot;参加过比赛的球队如下:&quot;);
            System.out
                    .print(&quot;-----------------------------------------------&quot;);
            System.out
                    .print(&quot;-----------------------------------------------rn&quot;);
            for (int i = 0; i &lt; vecAllTeams.size(); i++) {
                if (i % 7 == 0 &amp;&amp; i != 0) {
                    System.out.println(&quot;rn&quot;);
                }
                System.out.print(vecAllTeams.get(i) + &quot;t&quot;);
            }
        } else
            System.out.print(&quot;数据库目前没有数据,请按2收集数据!&quot;);
        System.out
                .print(&quot;rn---------------------------------------------&quot;);
        System.out
                .println(&quot;-----------------------------------------------rn&quot;);
    } else if (intInput == 4) {
        System.out.println(&quot;请输入你要查看的球队&quot;);
        Scanner scLeague = new Scanner(System.in);
        String strLeague = scLeague.next();
        //获取 具体球队的比赛结果
        Vector&lt;String&gt; lsResult = dQuery.querySpecifiedTeam(strLeague);
        if (lsResult.size() != 0) {
            System.out.println(&quot;日期ttt主队tt客队tt比分&quot;);
            for (int i = 0; i &lt; lsResult.size(); i++) {
                if (i % 4 == 0 &amp;&amp; i != 0)
                    System.out.println();
                System.out.print(lsResult.get(i) + &quot;tt&quot;);
            }
        } else
            System.out.println(&quot;没有相关球队的记录或数据库没有数据!&quot;);
        System.out
                .println(&quot;rn---------------------------------------------------&quot;);
    } else if (intInput == 5) {
        System.out.println(&quot;请输入你要查看的比赛日期  例子格式[14.01.2012]&quot;);
        Scanner scDate = new Scanner(System.in);
        String strDate = scDate.next();
        //获取具体日期下的 所有比赛
        List&lt;String&gt; lsResulOnDate = dQuery.queryByDate(strDate);
        if (lsResulOnDate.size() != 0) {
            System.out.println(&quot;日期ttt主队tt客队tt比分&quot;);
            for (int i = 0; i &lt; lsResulOnDate.size(); i++) {
                if (i % 4 == 0 &amp;&amp; i != 0)
                    System.out.println();
                System.out.print(lsResulOnDate.get(i) + &quot;tt&quot;);
            }
        } else
            System.out.println(&quot;该天没有比赛 或 数据库没有数据!&quot;);
        System.out
                .println(&quot;rn---------------------------------------------------&quot;);
    }
}
</code></pre><p> }<br>}<br><br><div></div><br><div></div></p>
<!--nextpage-->
<p>运行程序</p>
</li>
</ul>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200452123.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200452123.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入1 清空数据</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200453485.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200453485.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入2 开始收集数据 并存入数据库 - 初始阶段</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200455139.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200455139.png" alt=""></a></p>
<p>&nbsp;</p>
<p>开始收集数据 并存入数据库  - 结束阶段</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200460164.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200460164.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入3 查看所有参与过比赛的球队</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200473030.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200473030.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入4  再输入要查看的具体球队 这里查看的是 Swansea</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200482549.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200482549.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入5  再输入查看具体的日期 这里是 02.01.2012</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200491649.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200491649.png" alt=""></a></p>
<p>&nbsp;</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200493329.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200493329.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入1 我们测试下清空数据的效果 这里显示清空成功</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200494918.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200494918.png" alt=""></a></p>
<p>&nbsp;</p>
<p>输入3 查看下是否 真正在数据库中成功清空数据   结果显示 数据库目前没有数据</p>
<p><a href="http://pic002.cnblogs.com/images/2012/326877/2012021200504236.png" target="_blank" rel="external"><img src="http://pic002.cnblogs.com/images/2012/326877/2012021200504236.png" alt=""></a></p>
<p>这样，我们的数据查询功能也做好了 :)</p>
<p><a href="http://files.cnblogs.com/longwu/htmlDataQuery.zip" target="_blank" rel="external">附上源代码 下载</a></p>
<p>&nbsp;</p>

      
    </div>
    
    <div>
      
        
      
    </div>

    <div>
      
        
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/网页/" rel="tag">#网页</a>
          
            <a href="/tags/采集/" rel="tag">#采集</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2014/02/20/webpage-data-collector-2/" rel="next" title="Java网页数据采集器[中篇-数据存储]">
                <i class="fa fa-chevron-left"></i> Java网页数据采集器[中篇-数据存储]
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2014/02/21/square-map/" rel="prev" title="java swing 方格地图界面">
                java swing 方格地图界面 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2014/02/20/webpage-data-collector-3/"
     data-title="Java网页数据采集器[下篇-数据查询]"
     data-content=""
     data-url="http://yoursite.com/2014/02/20/webpage-data-collector-3/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2014/02/20/webpage-data-collector-3/"
           data-title="Java网页数据采集器[下篇-数据查询]" data-url="http://yoursite.com/2014/02/20/webpage-data-collector-3/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/head.jpg"
               alt="邱树荣" />
          <p class="site-author-name" itemprop="name">邱树荣</p>
          <p class="site-description motion-element" itemprop="description">致力于计算机程式开发</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">110</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">195</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="powered-by" >
  
  <span itemprop="copyrightYear">&copy;2016 - 2026</span>

  <a style="" class="theme-link" href="https://qiushurong.github.io">
    小树技术博客
  </a>

</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  粤ICP备<a class="theme-link" href="https://qiushurong.github.io">
    15021480
  </a>号
</div>

        

        
      </div>
    </footer>

    <!--qsuron20160418 返回顶部更换为火箭
    div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div-->

    <a id="rocket" href="#top" class=""></a>


  </div>


  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"qsuron"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
      
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  





  
  
  

  

  

</body>
</html>
